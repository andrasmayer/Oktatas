{"version":3,"file":"jquery.orgchart.min.js","sources":["jquery.orgchart.js"],"sourcesContent":["/*\r\n * jQuery OrgChart Plugin\r\n * https://github.com/dabeng/OrgChart\r\n *\r\n * Copyright 2016, dabeng\r\n * https://github.com/dabeng\r\n *\r\n * Licensed under the MIT license:\r\n * http://www.opensource.org/licenses/MIT\r\n */\r\n'use strict';\r\n\r\n(function (factory) {\r\n  if (typeof module === 'object' && typeof module.exports === 'object') {\r\n    factory(require('jquery'), window, document);\r\n  } else {\r\n    factory(jQuery, window, document);\r\n  }\r\n}(function ($, window, document, undefined) {\r\n  var OrgChart = function (elem, opts) {\r\n    this.$chartContainer = $(elem);\r\n    this.opts = opts;\r\n    this.defaultOptions = {\r\n      'icons': {\r\n        'theme': 'oci',\r\n        'parentNode': 'oci-menu',\r\n        'expandToUp': 'oci-chevron-up',\r\n        'collapseToDown': 'oci-chevron-down',\r\n        'collapseToLeft': 'oci-chevron-left',\r\n        'expandToRight': 'oci-chevron-right',\r\n        'backToCompact': 'oci-corner-top-left',\r\n        'backToLoose': 'oci-corner-bottom-right',\r\n        'collapsed': 'oci-plus-square',\r\n        'expanded': 'oci-minus-square',\r\n        'spinner': 'oci-spinner'\r\n      },\r\n      'nodeTitle': 'name',\r\n      'nodeId': 'id',\r\n      'toggleSiblingsResp': false,\r\n      'visibleLevel': 999,\r\n      'chartClass': '',\r\n      'exportButton': false,\r\n      'exportButtonName': 'Export',\r\n      'exportFilename': 'OrgChart',\r\n      'exportFileextension': 'png',\r\n      'draggable': false,\r\n      'direction': 't2b',\r\n      'pan': false,\r\n      'zoom': false,\r\n      'zoominLimit': 7,\r\n      'zoomoutLimit': 0.5\r\n    };\r\n  };\r\n  //\r\n  OrgChart.prototype = {\r\n    //\r\n    init: function (opts) {\r\n      var that = this;\r\n      this.options = $.extend({}, this.defaultOptions, this.opts, opts);\r\n      // build the org-chart\r\n      var $chartContainer = this.$chartContainer;\r\n      if (this.$chart) {\r\n        this.$chart.remove();\r\n      }\r\n      var data = this.options.data;\r\n      var $chart = this.$chart = $('<div>', {\r\n        'data': { 'options': this.options },\r\n        'class': 'orgchart' + (this.options.chartClass !== '' ? ' ' + this.options.chartClass : '') + (this.options.direction !== 't2b' ? ' ' + this.options.direction : ''),\r\n        'click': function(event) {\r\n          if (!$(event.target).closest('.node').length) {\r\n            $chart.find('.node.focused').removeClass('focused');\r\n          }\r\n        }\r\n      });\r\n      if (typeof MutationObserver !== 'undefined') {\r\n        this.triggerInitEvent();\r\n      }\r\n      var $root = $chart.append($('<ul class=\"nodes\"><li class=\"hierarchy\"></li></ul>')).find('.hierarchy');\r\n\r\n        if (data instanceof $) { // ul datasource\r\n          this.buildHierarchy($root, this.buildJsonDS(data.children()), 0, this.options);\r\n        } else { // local json datasource\r\n          if (data.relationship) {\r\n            this.buildHierarchy($root, data);\r\n          } else {\r\n            this.buildHierarchy($root, this.attachRel(data, '00'));\r\n          }\r\n        }\r\n\r\n      $chartContainer.append($chart);\r\n\r\n      // append the export button\r\n      if (this.options.exportButton && !$('.oc-export-btn').length) {\r\n        this.attachExportButton();\r\n      }\r\n\r\n      if (this.options.pan) {\r\n        this.bindPan();\r\n      }\r\n\r\n      if (this.options.zoom) {\r\n        this.bindZoom();\r\n      }\r\n\r\n      return this;\r\n    },\r\n    handleCompactNodes: function () {\r\n      // caculate the compact nodes' level which is used to add different styles\r\n      this.$chart.find('.node.compact')\r\n        .each((index, node) => {\r\n          $(node).addClass($(node).parents('.compact').length % 2 === 0 ? 'even' : 'odd');\r\n        }); // the following code snippets is used to add direction arrows for the most top compact node, however the styles is not adjusted correctly\r\n        // .filter((index, node) => !$(node).parent().is('.compact'))\r\n        // .each((index, node) => {\r\n        //   $(node).append(`<i class=\"edge verticalEdge topEdge ${this.options.icons.theme}\"></i>`);\r\n        //   if (this.getSiblings($(node)).length) {\r\n        //     $(node).append(`<i class=\"edge horizontalEdge rightEdge ${this.options.icons.theme}\"></i><i class=\"edge horizontalEdge leftEdge ${this.options.icons.theme}\"></i>`);\r\n        //   }\r\n        // });\r\n    },\r\n    //\r\n    triggerInitEvent: function () {\r\n      var that = this;\r\n      var mo = new MutationObserver(function (mutations) {\r\n        mo.disconnect();\r\n        initTime:\r\n        for (var i = 0; i < mutations.length; i++) {\r\n          for (var j = 0; j < mutations[i].addedNodes.length; j++) {\r\n            if (mutations[i].addedNodes[j].classList.contains('orgchart')) {\r\n              that.handleCompactNodes();\r\n              if (that.options.initCompleted && typeof that.options.initCompleted === 'function') {\r\n                that.options.initCompleted(that.$chart);\r\n              }\r\n              var initEvent = $.Event('init.orgchart');\r\n              that.$chart.trigger(initEvent);\r\n              break initTime;\r\n            }\r\n          }\r\n        }\r\n      });\r\n      mo.observe(this.$chartContainer[0], { childList: true });\r\n    },\r\n    triggerShowEvent: function ($target, rel) {\r\n      var initEvent = $.Event('show-' + rel + '.orgchart');\r\n      $target.trigger(initEvent);\r\n    },\r\n    triggerHideEvent: function ($target, rel) {\r\n      var initEvent = $.Event('hide-' + rel + '.orgchart');\r\n      $target.trigger(initEvent);\r\n    },\r\n    // add export button for orgchart\r\n    attachExportButton: function () {\r\n      var that = this;\r\n      var $exportBtn = $('<button>', {\r\n        'class': 'oc-export-btn',\r\n        'text': this.options.exportButtonName,\r\n        'click': function(e) {\r\n          e.preventDefault();\r\n          that.export();\r\n        }\r\n      });\r\n      this.$chartContainer.after($exportBtn);\r\n    },\r\n    setOptions: function (opts, val) {\r\n      if (typeof opts === 'string') {\r\n        if (opts === 'pan') {\r\n          if (val) {\r\n            this.bindPan();\r\n          } else {\r\n            this.unbindPan();\r\n          }\r\n        }\r\n        if (opts === 'zoom') {\r\n          if (val) {\r\n            this.bindZoom();\r\n          } else {\r\n            this.unbindZoom();\r\n          }\r\n        }\r\n      }\r\n      if (typeof opts === 'object') {\r\n        if (opts.data) {\r\n          this.init(opts);\r\n        } else {\r\n          if (typeof opts.pan !== 'undefined') {\r\n            if (opts.pan) {\r\n              this.bindPan();\r\n            } else {\r\n              this.unbindPan();\r\n            }\r\n          }\r\n          if (typeof opts.zoom !== 'undefined') {\r\n            if (opts.zoom) {\r\n              this.bindZoom();\r\n            } else {\r\n              this.unbindZoom();\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      return this;\r\n    },\r\n    //\r\n    panStartHandler: function (e) {\r\n      var $chart = $(e.delegateTarget);\r\n      if ($(e.target).closest('.node').length || (e.touches && e.touches.length > 1)) {\r\n        $chart.data('panning', false);\r\n        return;\r\n      } else {\r\n        $chart.css('cursor', 'move').data('panning', true);\r\n      }\r\n      var lastX = 0;\r\n      var lastY = 0;\r\n      var lastTf = $chart.css('transform');\r\n      if (lastTf !== 'none') {\r\n        var temp = lastTf.split(',');\r\n        if (lastTf.indexOf('3d') === -1) {\r\n          lastX = parseInt(temp[4]);\r\n          lastY = parseInt(temp[5]);\r\n        } else {\r\n          lastX = parseInt(temp[12]);\r\n          lastY = parseInt(temp[13]);\r\n        }\r\n      }\r\n      var startX = 0;\r\n      var startY = 0;\r\n      if (!e.targetTouches) { // pand on desktop\r\n        startX = e.pageX - lastX;\r\n        startY = e.pageY - lastY;\r\n      } else if (e.targetTouches.length === 1) { // pan on mobile device\r\n        startX = e.targetTouches[0].pageX - lastX;\r\n        startY = e.targetTouches[0].pageY - lastY;\r\n      } else if (e.targetTouches.length > 1) {\r\n        return;\r\n      }\r\n      $chart.on('mousemove touchmove',function(e) {\r\n        if (!$chart.data('panning')) {\r\n          return;\r\n        }\r\n        var newX = 0;\r\n        var newY = 0;\r\n        if (!e.targetTouches) { // pand on desktop\r\n          newX = e.pageX - startX;\r\n          newY = e.pageY - startY;\r\n        } else if (e.targetTouches.length === 1) { // pan on mobile device\r\n          newX = e.targetTouches[0].pageX - startX;\r\n          newY = e.targetTouches[0].pageY - startY;\r\n        } else if (e.targetTouches.length > 1) {\r\n          return;\r\n        }\r\n        var lastTf = $chart.css('transform');\r\n        if (lastTf === 'none') {\r\n          if (lastTf.indexOf('3d') === -1) {\r\n            $chart.css('transform', 'matrix(1, 0, 0, 1, ' + newX + ', ' + newY + ')');\r\n          } else {\r\n            $chart.css('transform', 'matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, ' + newX + ', ' + newY + ', 0, 1)');\r\n          }\r\n        } else {\r\n          var matrix = lastTf.split(',');\r\n          if (lastTf.indexOf('3d') === -1) {\r\n            matrix[4] = ' ' + newX;\r\n            matrix[5] = ' ' + newY + ')';\r\n          } else {\r\n            matrix[12] = ' ' + newX;\r\n            matrix[13] = ' ' + newY;\r\n          }\r\n          $chart.css('transform', matrix.join(','));\r\n        }\r\n      });\r\n    },\r\n    //\r\n    panEndHandler: function (e) {\r\n      if (e.data.chart.data('panning')) {\r\n        e.data.chart.data('panning', false).css('cursor', 'default').off('mousemove');\r\n      }\r\n    },\r\n    //\r\n    bindPan: function () {\r\n      this.$chartContainer.css('overflow', 'hidden');\r\n      this.$chart.on('mousedown touchstart', this.panStartHandler);\r\n      $(document).on('mouseup touchend', { 'chart': this.$chart }, this.panEndHandler);\r\n    },\r\n    //\r\n    unbindPan: function () {\r\n      this.$chartContainer.css('overflow', 'auto');\r\n      this.$chart.off('mousedown touchstart', this.panStartHandler);\r\n      $(document).off('mouseup touchend', this.panEndHandler);\r\n    },\r\n    //\r\n    zoomWheelHandler: function (e) {\r\n      var oc = e.data.oc;\r\n      e.preventDefault();\r\n      var newScale  = 1 + (e.originalEvent.deltaY > 0 ? -0.2 : 0.2);\r\n      oc.setChartScale(oc.$chart, newScale);\r\n    },\r\n    //\r\n    zoomStartHandler: function (e) {\r\n      if(e.touches && e.touches.length === 2) {\r\n        var oc = e.data.oc;\r\n        oc.$chart.data('pinching', true);\r\n        var dist = oc.getPinchDist(e);\r\n        oc.$chart.data('pinchDistStart', dist);\r\n      }\r\n    },\r\n    zoomingHandler: function (e) {\r\n      var oc = e.data.oc;\r\n      if(oc.$chart.data('pinching')) {\r\n        var dist = oc.getPinchDist(e);\r\n        oc.$chart.data('pinchDistEnd', dist);\r\n      }\r\n    },\r\n    zoomEndHandler: function (e) {\r\n      var oc = e.data.oc;\r\n      if(oc.$chart.data('pinching')) {\r\n        oc.$chart.data('pinching', false);\r\n        var diff = oc.$chart.data('pinchDistEnd') - oc.$chart.data('pinchDistStart');\r\n        if (diff > 0) {\r\n          oc.setChartScale(oc.$chart, 1.2);\r\n        } else if (diff < 0) {\r\n          oc.setChartScale(oc.$chart, 0.8);\r\n        }\r\n      }\r\n    },\r\n    //\r\n    bindZoom: function () {\r\n      this.$chartContainer.on('wheel', { 'oc': this }, this.zoomWheelHandler);\r\n      this.$chartContainer.on('touchstart', { 'oc': this }, this.zoomStartHandler);\r\n      $(document).on('touchmove', { 'oc': this }, this.zoomingHandler);\r\n      $(document).on('touchend', { 'oc': this }, this.zoomEndHandler);\r\n    },\r\n    unbindZoom: function () {\r\n      this.$chartContainer.off('wheel', this.zoomWheelHandler);\r\n      this.$chartContainer.off('touchstart', this.zoomStartHandler);\r\n      $(document).off('touchmove', this.zoomingHandler);\r\n      $(document).off('touchend', this.zoomEndHandler);\r\n    },\r\n    //\r\n    getPinchDist: function (e) {\r\n      return Math.sqrt((e.touches[0].clientX - e.touches[1].clientX) * (e.touches[0].clientX - e.touches[1].clientX) +\r\n      (e.touches[0].clientY - e.touches[1].clientY) * (e.touches[0].clientY - e.touches[1].clientY));\r\n    },\r\n    //\r\n    setChartScale: function ($chart, newScale) {\r\n      var opts = $chart.data('options');\r\n      var lastTf = $chart.css('transform');\r\n      var matrix = '';\r\n      var targetScale = 1;\r\n      if (lastTf === 'none') {\r\n        $chart.css('transform', 'scale(' + newScale + ',' + newScale + ')');\r\n      } else {\r\n        matrix = lastTf.split(',');\r\n        if (lastTf.indexOf('3d') === -1) {\r\n          targetScale = Math.abs(window.parseFloat(matrix[3]) * newScale);\r\n          if (targetScale > opts.zoomoutLimit && targetScale < opts.zoominLimit) {\r\n            $chart.css('transform', lastTf + ' scale(' + newScale + ',' + newScale + ')');\r\n          }\r\n        } else {\r\n          targetScale = Math.abs(window.parseFloat(matrix[1]) * newScale);\r\n          if (targetScale > opts.zoomoutLimit && targetScale < opts.zoominLimit) {\r\n            $chart.css('transform', lastTf + ' scale3d(' + newScale + ',' + newScale + ', 1)');\r\n          }\r\n        }\r\n      }\r\n    },\r\n    //\r\n    buildJsonDS: function ($li) {\r\n      var that = this;\r\n      var subObj = {\r\n        'name': $li.contents().eq(0).text().trim(),\r\n        'relationship': ($li.parent().parent().is('li') ? '1': '0') + ($li.siblings('li').length ? 1: 0) + ($li.children('ul').length ? 1 : 0)\r\n      };\r\n      $.each($li.data(), function(key, value) {\r\n         subObj[key] = value;\r\n      });\r\n      $li.children('ul').children().each(function() {\r\n        if (!subObj.children) { subObj.children = []; }\r\n        subObj.children.push(that.buildJsonDS($(this)));\r\n      });\r\n      return subObj;\r\n    },\r\n    // process datasource and add necessary information\r\n    attachRel: function (data, flags) {\r\n      var that = this;\r\n      data.relationship = flags + (data.children && data.children.length > 0 ? 1 : 0);\r\n      if (this.options?.compact?.constructor === Function && this.options.compact(data)) {\r\n        data.compact = true;\r\n      }\r\n      if (data.children) {\r\n        data.children.forEach(function(item) {\r\n          if (data.hybrid || data.vertical) { // identify all the descendant nodes except the root node of hybrid structure\r\n            item.vertical = true;\r\n          } else if (data.compact && item.children) { // identify all the compact ancestor nodes\r\n            item.compact = true;\r\n          } else if (data.compact && !item.children) { // identify all the compact descendant nodes\r\n            item.associatedCompact = true;\r\n          }\r\n          that.attachRel(item, '1' + (data.children.length > 1 ? 1 : 0));\r\n        });\r\n      }\r\n      return data;\r\n    },\r\n    //\r\n    loopChart: function ($chart, includeNodeData) {\r\n      includeNodeData = (includeNodeData !== null && includeNodeData !== undefined) ? includeNodeData : false;\r\n      var that = this;\r\n      var $node = $chart.find('.node:first');\r\n      var subObj = { 'id': $node[0].id };\r\n      if (includeNodeData) {\r\n        $.each($node.data('nodeData'), function (key, value) {\r\n          subObj[key] = value;\r\n        });\r\n      }\r\n      $node.siblings('.nodes').children().each(function() {\r\n        if (!subObj.children) { subObj.children = []; }\r\n        subObj.children.push(that.loopChart($(this), includeNodeData));\r\n      });\r\n      return subObj;\r\n    },\r\n    //\r\n    getHierarchy: function (includeNodeData) {\r\n      includeNodeData = (includeNodeData !== null && includeNodeData !== undefined) ? includeNodeData : false;\r\n      if (typeof this.$chart === 'undefined') {\r\n        return 'Error: orgchart does not exist'\r\n      } else {\r\n        if (!this.$chart.find('.node').length) {\r\n          return 'Error: nodes do not exist'\r\n        } else {\r\n          var valid = true;\r\n          this.$chart.find('.node').each(function () {\r\n            if (!this.id) {\r\n              valid = false;\r\n              return false;\r\n            }\r\n          });\r\n          if (!valid) {\r\n            return 'Error: All nodes of orghcart to be exported must have data-id attribute!';\r\n          }\r\n        }\r\n      }\r\n      return this.loopChart(this.$chart, includeNodeData);\r\n    },\r\n    // detect the exist/display state of related node\r\n    getNodeState: function ($node, relation) {\r\n      var $target = {};\r\n      var isVerticalNode = !!$node.closest('vertical').length;\r\n      var relation = relation || 'self';\r\n      if (relation === 'parent') {\r\n        if (isVerticalNode) {\r\n          $target = $node.closest('ul').parents('ul');\r\n          if (!$target.length) {\r\n            $target = $node.closest('.nodes');\r\n            if (!$target.length) {\r\n              $target = $node.closest('.vertical').siblings(':first');\r\n            }\r\n          }\r\n        } else {\r\n          $target = $node.closest('.nodes').siblings('.node');\r\n        }\r\n        if ($target.length) {\r\n          if ($target.is('.hidden') || (!$target.is('.hidden') && $target.closest('.nodes').is('.hidden')) || (!$target.is('.hidden') && $target.closest('.vertical').is('.hidden'))) {\r\n            return { 'exist': true, 'visible': false };\r\n          }\r\n          return { 'exist': true, 'visible': true };\r\n        }\r\n      } else if (relation === 'children') {\r\n        $target = isVerticalNode ? $node.parent().children('ul') : $node.siblings('.nodes');\r\n        if ($target.length) {\r\n          if (!$target.is('.hidden')) {\r\n            return { 'exist': true, 'visible': true };\r\n          }\r\n          return { 'exist': true, 'visible': false };\r\n        }\r\n      } else if (relation === 'siblings') {\r\n        $target = isVerticalNode ? $node.closest('ul') : $node.parent().siblings();\r\n        if ($target.length && (!isVerticalNode || $target.children('li').length > 1)) {\r\n          if (!$target.is('.hidden') && !$target.parent().is('.hidden') && (!isVerticalNode || !$target.closest('.vertical').is('.hidden'))) {\r\n            return { 'exist': true, 'visible': true };\r\n          }\r\n          return { 'exist': true, 'visible': false };\r\n        }\r\n      } else {\r\n        $target = $node;\r\n        if ($target.length) {\r\n          if (!(($target.closest('.nodes').length && $target.closest('.nodes').is('.hidden')) ||\r\n            ($target.closest('.hierarchy').length && $target.closest('.hierarchy').is('.hidden')) ||\r\n            ($target.closest('.vertical').length && ($target.closest('.nodes').is('.hidden') || $target.closest('.vertical').is('.hidden')))\r\n          )) {\r\n            return { 'exist': true, 'visible': true };\r\n          }\r\n          return { 'exist': true, 'visible': false };\r\n        }\r\n      }\r\n      return { 'exist': false, 'visible': false };\r\n    },\r\n    getParent: function ($node) {\r\n      return this.getRelatedNodes($node, 'parent');\r\n    },\r\n    getChildren: function ($node) {\r\n      return this.getRelatedNodes($node, 'children');\r\n    },\r\n    getSiblings: function ($node) {\r\n      return this.getRelatedNodes($node, 'siblings');\r\n    },\r\n    // find the related nodes\r\n    getRelatedNodes: function ($node, relation) {\r\n      if (!$node || !($node instanceof $) || !$node.is('.node')) {\r\n        return $();\r\n      }\r\n      if (relation === 'parent') {\r\n        return $node.closest('.nodes').siblings('.node');\r\n      } else if (relation === 'children') {\r\n        return $node.siblings('.nodes').children('.hierarchy').find('.node:first');\r\n      } else if (relation === 'siblings') {\r\n        return $node.closest('.hierarchy').siblings().find('.node:first');\r\n      } else {\r\n        return $();\r\n      }\r\n    },\r\n    hideParentEnd: function (event) {\r\n      $(event.target).removeClass('sliding');\r\n      event.data.parent.addClass('hidden');\r\n    },\r\n    // recursively hide the ancestor node and sibling nodes of the specified node\r\n    hideParent: function ($node) {\r\n      var $parent = $node.closest('.nodes').siblings('.node');\r\n      if ($parent.find('.spinner').length) {\r\n        $node.closest('.orgchart').data('inAjax', false);\r\n      }\r\n      // hide the sibling nodes\r\n      if (this.getNodeState($node, 'siblings').visible) {\r\n        this.hideSiblings($node);\r\n      }\r\n      // hide the lines\r\n      $node.parent().addClass('isAncestorsCollapsed');\r\n      // hide the superior nodes with transition\r\n      if (this.getNodeState($parent).visible) {\r\n        $parent.addClass('sliding slide-down').one('transitionend', { 'parent': $parent }, this.hideParentEnd);\r\n      }\r\n      // if the current node has the parent node, hide it recursively\r\n      if (this.getNodeState($parent, 'parent').visible) {\r\n        this.hideParent($parent);\r\n      }\r\n    },\r\n    showParentEnd: function (event) {\r\n      var $node = event.data.node;\r\n      $(event.target).removeClass('sliding');\r\n      if (this.isInAction($node)) {\r\n        this.switchVerticalArrow($node.children('.topEdge'));\r\n      }\r\n    },\r\n    // show the parent node of the specified node\r\n    showParent: function ($node) {\r\n      // just show only one superior level\r\n      var $parent = $node.closest('.nodes').siblings('.node').removeClass('hidden');\r\n      // just show only one line\r\n      $node.closest('.hierarchy').removeClass('isAncestorsCollapsed');\r\n      // show parent node with animation\r\n      this.repaint($parent[0]);\r\n      $parent.addClass('sliding').removeClass('slide-down').one('transitionend', { 'node': $node }, this.showParentEnd.bind(this));\r\n    },\r\n    stopAjax: function ($nodeLevel) {\r\n      if ($nodeLevel.find('.spinner').length) {\r\n        $nodeLevel.closest('.orgchart').data('inAjax', false);\r\n      }\r\n    },\r\n    isVisibleNode: function (index, elem) {\r\n      return this.getNodeState($(elem)).visible;\r\n    },\r\n    isCompactDescendant: function (index, elem) {\r\n      return $(elem).parent().is('.node.compact');\r\n    },\r\n    // do some necessary cleanup tasks when hide animation is finished\r\n    hideChildrenEnd: function (event) {\r\n      var $node = event.data.node;\r\n      event.data.animatedNodes.removeClass('sliding');\r\n      event.data.animatedNodes.closest('.nodes').addClass('hidden');\r\n      if (this.isInAction($node)) {\r\n        this.switchVerticalArrow($node.children('.bottomEdge'));\r\n      }\r\n    },\r\n    // recursively hide the descendant nodes of the specified node\r\n    hideChildren: function ($node) {\r\n      $node.closest('.hierarchy').addClass('isChildrenCollapsed');\r\n      var $lowerLevel = $node.siblings('.nodes');\r\n      this.stopAjax($lowerLevel);\r\n      var $animatedNodes = $lowerLevel.find('.node').filter(this.isVisibleNode.bind(this)).not(this.isCompactDescendant.bind(this));\r\n      var isVerticalDesc = $lowerLevel.is('.vertical');\r\n      if (!isVerticalDesc) {\r\n        $animatedNodes.closest('.hierarchy').addClass('isCollapsedDescendant');\r\n      }\r\n      if ($lowerLevel.is('.vertical') || $lowerLevel.find('.vertical').length) {\r\n        $animatedNodes.find(this.options.icons.expanded).removeClass(this.options.icons.expanded).addClass(this.options.icons.collapsed);\r\n      }\r\n      this.repaint($animatedNodes.get(0));\r\n      $animatedNodes.addClass('sliding slide-up').eq(0).one('transitionend', { 'animatedNodes': $animatedNodes, 'lowerLevel': $lowerLevel, 'node': $node }, this.hideChildrenEnd.bind(this));\r\n    },\r\n    //\r\n    showChildrenEnd: function (event) {\r\n      var $node = event.data.node;\r\n      event.data.animatedNodes.removeClass('sliding');\r\n      if (this.isInAction($node)) {\r\n        this.switchVerticalArrow($node.children('.bottomEdge'));\r\n      }\r\n    },\r\n    // show the children nodes of the specified node\r\n    showChildren: function ($node) {\r\n      var that = this;\r\n      $node.closest('.hierarchy').removeClass('isChildrenCollapsed');\r\n      var $levels = $node.siblings('.nodes');\r\n      var isVerticalDesc = $levels.is('.vertical');\r\n      var $animatedNodes = isVerticalDesc\r\n        ? $levels.removeClass('hidden').find('.node').filter(this.isVisibleNode.bind(this))\r\n        : $levels.removeClass('hidden').children('.hierarchy').find('.node:first').filter(this.isVisibleNode.bind(this));\r\n      if (!isVerticalDesc) {\r\n        $animatedNodes.filter(':not(:only-child)').closest('.hierarchy').addClass('isChildrenCollapsed');\r\n        $animatedNodes.closest('.hierarchy').removeClass('isCollapsedDescendant');\r\n      }\r\n      // the two following statements are used to enforce browser to repaint\r\n      this.repaint($animatedNodes.get(0));\r\n      $animatedNodes.addClass('sliding').removeClass('slide-up').eq(0).one('transitionend', { 'node': $node, 'animatedNodes': $animatedNodes }, this.showChildrenEnd.bind(this));\r\n    },\r\n    //\r\n    hideSiblingsEnd: function (event) {\r\n      var that = this;\r\n      var $node = event.data.node;\r\n      var $nodeContainer = event.data.nodeContainer;\r\n      var direction = event.data.direction;\r\n      var $siblings = direction ? (direction === 'left' ? $nodeContainer.prevAll(':not(.hidden)') : $nodeContainer.nextAll(':not(.hidden)')) : $nodeContainer.siblings();\r\n      event.data.animatedNodes.removeClass('sliding');\r\n      $siblings.find('.node:gt(0)').filter(this.isVisibleNode.bind(this))\r\n        .removeClass('slide-left slide-right')\r\n        .addClass(function() {\r\n          if (that.options.compact) {\r\n            return '';\r\n          } else {\r\n            return 'slide-up';\r\n          }\r\n        });\r\n      $siblings.find('.nodes, .vertical').addClass('hidden')\r\n        .end().addClass('hidden');\r\n\r\n      if (this.isInAction($node)) {\r\n        this.switchHorizontalArrow($node);\r\n      }\r\n    },\r\n    // hide the sibling nodes of the specified node\r\n    hideSiblings: function ($node, direction) {\r\n      var that = this;\r\n      var $nodeContainer = $node.closest('.hierarchy').addClass('isSiblingsCollapsed');\r\n      if ($nodeContainer.siblings().find('.spinner').length) {\r\n        $node.closest('.orgchart').data('inAjax', false);\r\n      }\r\n      if (direction) {\r\n        if (direction === 'left') {\r\n          $nodeContainer.addClass('left-sibs')\r\n            .prevAll('.isSiblingsCollapsed').removeClass('isSiblingsCollapsed left-sibs').end()\r\n            .prevAll().addClass('isCollapsedSibling isChildrenCollapsed')\r\n            .find('.node').filter(this.isVisibleNode.bind(this)).addClass('sliding slide-right');\r\n        } else {\r\n          $nodeContainer.addClass('right-sibs')\r\n            .nextAll('.isSiblingsCollapsed').removeClass('isSiblingsCollapsed right-sibs').end()\r\n            .nextAll().addClass('isCollapsedSibling isChildrenCollapsed')\r\n            .find('.node').filter(this.isVisibleNode.bind(this)).addClass('sliding slide-left');\r\n        }\r\n      } else {\r\n        $nodeContainer.prevAll().find('.node').filter(this.isVisibleNode.bind(this)).addClass('sliding slide-right');\r\n        $nodeContainer.nextAll().find('.node').filter(this.isVisibleNode.bind(this)).addClass('sliding slide-left');\r\n        $nodeContainer.siblings().addClass('isCollapsedSibling isChildrenCollapsed');\r\n      }\r\n      var $animatedNodes = $nodeContainer.siblings().find('.sliding');\r\n      $animatedNodes.eq(0).one('transitionend', { 'node': $node, 'nodeContainer': $nodeContainer, 'direction': direction, 'animatedNodes': $animatedNodes }, this.hideSiblingsEnd.bind(this));\r\n    },\r\n    //\r\n    showSiblingsEnd: function (event) {\r\n      var $node = event.data.node;\r\n      event.data.visibleNodes.removeClass('sliding');\r\n      if (this.isInAction($node)) {\r\n        this.switchHorizontalArrow($node);\r\n        $node.children('.topEdge').removeClass(this.options.icons.expandToUp).addClass(this.options.icons.collapseToDown);\r\n      }\r\n    },\r\n    //\r\n    showRelatedParentEnd: function(event) {\r\n      $(event.target).removeClass('sliding');\r\n    },\r\n    // show the sibling nodes of the specified node\r\n    showSiblings: function ($node, direction) {\r\n      var that = this;\r\n      // firstly, show the sibling nodes\r\n      var $siblings = $();\r\n      var $nodeContainer = $node.closest('.hierarchy');\r\n      if (direction) {\r\n        if (direction === 'left') {\r\n          $siblings = $nodeContainer.prevAll().removeClass('hidden');\r\n        } else {\r\n          $siblings = $nodeContainer.nextAll().removeClass('hidden');\r\n        }\r\n      } else {\r\n        $siblings = $node.closest('.hierarchy').siblings().removeClass('hidden');\r\n      }\r\n      // secondly, show the lines\r\n      var $upperLevel = $node.closest('.nodes').siblings('.node');\r\n      if (direction) {\r\n        $nodeContainer.removeClass(direction + '-sibs');\r\n        if (!$nodeContainer.is('[class*=-sibs]')) {\r\n          $nodeContainer.removeClass('isSiblingsCollapsed');\r\n        }\r\n        $siblings.removeClass('isCollapsedSibling ' + direction + '-sibs');\r\n      } else {\r\n        $node.closest('.hierarchy').removeClass('isSiblingsCollapsed');\r\n        $siblings.removeClass('isCollapsedSibling');\r\n      }\r\n      // thirdly, show parent node if it is collapsed\r\n      if (!this.getNodeState($node, 'parent').visible) {\r\n        $node.closest('.hierarchy').removeClass('isAncestorsCollapsed');\r\n        $upperLevel.removeClass('hidden');\r\n        this.repaint($upperLevel[0]);\r\n        $upperLevel.addClass('sliding').removeClass('slide-down').one('transitionend', this.showRelatedParentEnd);\r\n      }\r\n      // lastly, show the sibling nodes with animation\r\n      var $visibleNodes = $siblings.find('.node').filter(this.isVisibleNode.bind(this));\r\n      this.repaint($visibleNodes.get(0));\r\n      $visibleNodes.addClass('sliding').removeClass('slide-left slide-right');\r\n      $visibleNodes.eq(0).one('transitionend', { 'node': $node, 'visibleNodes': $visibleNodes }, this.showSiblingsEnd.bind(this));\r\n    },\r\n    // start up loading status for requesting new nodes\r\n    startLoading: function ($edge) {\r\n      var $chart = this.$chart;\r\n      if (typeof $chart.data('inAjax') !== 'undefined' && $chart.data('inAjax') === true) {\r\n        return false;\r\n      }\r\n\r\n      $edge.addClass('hidden');\r\n      $edge.parent().append(`<i class=\"${this.options.icons.theme} ${this.options.icons.spinner} spinner\"></i>`)\r\n        .children().not('.spinner').css('opacity', 0.2);\r\n      $chart.data('inAjax', true);\r\n      $('.oc-export-btn').prop('disabled', true);\r\n      return true;\r\n    },\r\n    // terminate loading status for requesting new nodes\r\n    endLoading: function ($edge) {\r\n      var $node = $edge.parent();\r\n      $edge.removeClass('hidden');\r\n      $node.find('.spinner').remove();\r\n      $node.children().removeAttr('style');\r\n      this.$chart.data('inAjax', false);\r\n      $('.oc-export-btn').prop('disabled', false);\r\n    },\r\n    // whether the cursor is hovering over the node\r\n    isInAction: function ($node) {\r\n      return [\r\n        this.options.icons.expandToUp,\r\n        this.options.icons.collapseToDown,\r\n        this.options.icons.collapseToLeft,\r\n        this.options.icons.expandToRight\r\n      ].some((icon) => $node.children('.edge').attr('class').indexOf(icon) > -1);\r\n    },\r\n    //\r\n    switchVerticalArrow: function ($arrow) {\r\n      $arrow.toggleClass(`${this.options.icons.expandToUp} ${this.options.icons.collapseToDown}`);\r\n    },\r\n    //\r\n    switchHorizontalArrow: function ($node) {\r\n      var opts = this.options;\r\n      if (opts.toggleSiblingsResp && (typeof opts.ajaxURL === 'undefined' || $node.closest('.nodes').data('siblingsLoaded'))) {\r\n        var $prevSib = $node.parent().prev();\r\n        if ($prevSib.length) {\r\n          if ($prevSib.is('.hidden')) {\r\n            $node.children('.leftEdge').addClass(opts.icons.collapseToLeft).removeClass(opts.icons.expandToRight);\r\n          } else {\r\n            $node.children('.leftEdge').addClass(opts.icons.expandToRight).removeClass(opts.icons.collapseToLeft);\r\n          }\r\n        }\r\n        var $nextSib = $node.parent().next();\r\n        if ($nextSib.length) {\r\n          if ($nextSib.is('.hidden')) {\r\n            $node.children('.rightEdge').addClass(opts.icons.expandToRight).removeClass(opts.icons.collapseToLeft);\r\n          } else {\r\n            $node.children('.rightEdge').addClass(opts.icons.collapseToLeft).removeClass(opts.icons.expandToRight);\r\n          }\r\n        }\r\n      } else {\r\n        var $sibs = $node.parent().siblings();\r\n        var sibsVisible = $sibs.length ? !$sibs.is('.hidden') : false;\r\n        $node.children('.leftEdge').toggleClass(opts.icons.expandToRight, sibsVisible).toggleClass(opts.icons.collapseToLeft, !sibsVisible);\r\n        $node.children('.rightEdge').toggleClass(opts.icons.collapseToLeft, sibsVisible).toggleClass(opts.icons.expandToRight, !sibsVisible);\r\n      }\r\n    },\r\n    //\r\n    repaint: function (node) {\r\n      if (node) {\r\n        node.style.offsetWidth = node.offsetWidth;\r\n      }\r\n    },\r\n    // determines how to show arrow buttons \r\n    nodeEnterLeaveHandler: function (event) {\r\n      var $node = $(event.delegateTarget);\r\n      var flag = false;\r\n      if ($node.closest('.nodes.vertical').length) {\r\n        var $toggleBtn = $node.children('.toggleBtn');\r\n        if (event.type === 'mouseenter') {\r\n          if ($node.children('.toggleBtn').length) {\r\n            flag = this.getNodeState($node, 'children').visible;\r\n            $toggleBtn.toggleClass(this.options.icons.collapsed, !flag).toggleClass(this.options.icons.expanded, flag);\r\n          }\r\n        } else {\r\n          $toggleBtn.removeClass(`${this.options.icons.collapsed} ${this.options.icons.expanded}`);\r\n        }\r\n      } else {\r\n        var $topEdge = $node.children('.topEdge');\r\n        var $rightEdge = $node.children('.rightEdge');\r\n        var $bottomEdge = $node.children('.bottomEdge');\r\n        var $leftEdge = $node.children('.leftEdge');\r\n        if (event.type === 'mouseenter') {\r\n          if ($topEdge.length) {\r\n            flag = this.getNodeState($node, 'parent').visible;\r\n            $topEdge.toggleClass(this.options.icons.expandToUp, !flag).toggleClass(this.options.icons.collapseToDown, flag);\r\n          }\r\n          if ($bottomEdge.length) {\r\n            flag = this.getNodeState($node, 'children').visible;\r\n            $bottomEdge.toggleClass(this.options.icons.collapseToDown, !flag).toggleClass(this.options.icons.expandToUp, flag);\r\n          }\r\n          if ($leftEdge.length) {\r\n            this.switchHorizontalArrow($node);\r\n          }\r\n        } else {\r\n          $node.children('.edge').removeClass(`${this.options.icons.expandToUp} ${this.options.icons.collapseToDown} ${this.options.icons.collapseToLeft} ${this.options.icons.expandToRight}`);\r\n        }\r\n      }\r\n    },\r\n    //\r\n    nodeClickHandler: function (event) {\r\n      this.$chart.find('.focused').removeClass('focused');\r\n      $(event.delegateTarget).addClass('focused');\r\n    },\r\n    addAncestors: function (data, parentId) {\r\n      var $root = this.$chart.children('.nodes').children('.hierarchy');\r\n      this.buildHierarchy($root, data);\r\n      $root.children().slice(0, 2)\r\n        .wrapAll('<li class=\"hierarchy\"></li>').parent()\r\n        .appendTo($('#' + parentId).siblings('.nodes'));\r\n    },\r\n    addDescendants:function (data, $parent) {\r\n      var that = this;\r\n      var $descendants = $('<ul class=\"nodes\"></ul>');\r\n      $parent.after($descendants);\r\n      $.each(data, function (i) {\r\n        $descendants.append($('<li class=\"hierarchy\"></li>'));\r\n        that.buildHierarchy($descendants.children().eq(i), this);\r\n      });\r\n    },\r\n    //\r\n    HideFirstParentEnd: function (event) {\r\n      var $topEdge = event.data.topEdge;\r\n      var $node = $topEdge.parent();\r\n      if (this.isInAction($node)) {\r\n        this.switchVerticalArrow($topEdge);\r\n        this.switchHorizontalArrow($node);\r\n      }\r\n    },\r\n    // actions on clinking top edge of a node\r\n    topEdgeClickHandler: function (event) {\r\n      var that = this;\r\n      var $topEdge = $(event.target);\r\n      var $node = $(event.delegateTarget);\r\n      var parentState = this.getNodeState($node, 'parent');\r\n      if (parentState.exist) {\r\n        var $parent = $node.closest('.nodes').siblings('.node');\r\n        if ($parent.is('.sliding')) { return; }\r\n        // hide the ancestor nodes and sibling nodes of the specified node\r\n        if (parentState.visible) {\r\n          this.hideParent($node);\r\n          $parent.one('transitionend', { 'topEdge': $topEdge }, this.HideFirstParentEnd.bind(this));\r\n          this.triggerHideEvent($node, 'parent');\r\n        } else { // show the ancestors and siblings\r\n          this.showParent($node);\r\n          this.triggerShowEvent($node, 'parent');\r\n        }\r\n      }\r\n    },\r\n    // actions on clinking bottom edge of a node\r\n    bottomEdgeClickHandler: function (event) {\r\n      var $bottomEdge = $(event.target);\r\n      var $node = $(event.delegateTarget);\r\n      var childrenState = this.getNodeState($node, 'children');\r\n      if (childrenState.exist) {\r\n        var $children = $node.siblings('.nodes').children().children('.node');\r\n        if ($children.is('.sliding')) { return; }\r\n        // hide the descendant nodes of the specified node\r\n        if (childrenState.visible) {\r\n          this.hideChildren($node);\r\n          this.triggerHideEvent($node, 'children');\r\n        } else { // show the descendants\r\n          this.showChildren($node);\r\n          this.triggerShowEvent($node, 'children');\r\n        }\r\n      }\r\n    },\r\n    // actions on clicking horizontal edges\r\n    hEdgeClickHandler: function (event) {\r\n      var $hEdge = $(event.target);\r\n      var $node = $(event.delegateTarget);\r\n      var opts = this.options;\r\n      var siblingsState = this.getNodeState($node, 'siblings');\r\n      if (siblingsState.exist) {\r\n        var $siblings = $node.closest('.hierarchy').siblings();\r\n        if ($siblings.find('.sliding').length) { return; }\r\n        if (opts.toggleSiblingsResp) {\r\n          var $prevSib = $node.closest('.hierarchy').prev();\r\n          var $nextSib = $node.closest('.hierarchy').next();\r\n          if ($hEdge.is('.leftEdge')) {\r\n            if ($prevSib.is('.hidden')) {\r\n              this.showSiblings($node, 'left');\r\n              this.triggerShowEvent($node,'siblings');\r\n            } else {\r\n              this.hideSiblings($node, 'left');\r\n              this.triggerHideEvent($node, 'siblings');\r\n            }\r\n          } else {\r\n            if ($nextSib.is('.hidden')) {\r\n              this.showSiblings($node, 'right');\r\n              this.triggerShowEvent($node,'siblings');\r\n            } else {\r\n              this.hideSiblings($node, 'right');\r\n              this.triggerHideEvent($node, 'siblings');\r\n            }\r\n          }\r\n        } else {\r\n          if (siblingsState.visible) {\r\n            this.hideSiblings($node);\r\n            this.triggerHideEvent($node, 'siblings');\r\n          } else {\r\n            this.showSiblings($node);\r\n            this.triggerShowEvent($node, 'siblings');\r\n          }\r\n        }\r\n      }\r\n    },\r\n    // show the compact node's children in the compact mode\r\n    backToCompactHandler: function (event) {\r\n      $(event.delegateTarget).removeClass('looseMode')\r\n        .find('.looseMode').removeClass('looseMode')\r\n        .children('.backToCompactSymbol').addClass('hidden').end()\r\n        .children('.backToLooseSymbol').removeClass('hidden');\r\n      $(event.delegateTarget).children('.backToCompactSymbol').addClass('hidden').end()\r\n        .children('.backToLooseSymbol').removeClass('hidden');\r\n    },\r\n    // show the compact node's children in the loose mode \r\n    backToLooseHandler: function (event) {\r\n      $(event.delegateTarget)\r\n        .addClass('looseMode')\r\n        .children('.backToLooseSymbol').addClass('hidden').end()\r\n        .children('.backToCompactSymbol').removeClass('hidden');\r\n    },\r\n    //\r\n    expandVNodesEnd: function (event) {\r\n      event.data.vNodes.removeClass('sliding');\r\n    },\r\n    //\r\n    collapseVNodesEnd: function (event) {\r\n      event.data.vNodes.removeClass('sliding').closest('ul').addClass('hidden');\r\n    },\r\n    // event handler for toggle buttons in Hybrid(horizontal + vertical) OrgChart\r\n    toggleVNodes: function (event) {\r\n      var $toggleBtn = $(event.target);\r\n      var $descWrapper = $toggleBtn.parent().next();\r\n      var $descendants = $descWrapper.find('.node');\r\n      var $children = $descWrapper.children().children('.node');\r\n      if ($children.is('.sliding')) { return; }\r\n      $toggleBtn.toggleClass(`${this.options.icons.collapsed} ${this.options.icons.expanded}`);\r\n      if ($descendants.eq(0).is('.slide-up')) {\r\n        $descWrapper.removeClass('hidden');\r\n        this.repaint($children.get(0));\r\n        $children.addClass('sliding').removeClass('slide-up').eq(0).one('transitionend', { 'vNodes': $children }, this.expandVNodesEnd);\r\n      } else {\r\n        $descendants.addClass('sliding slide-up').eq(0).one('transitionend', { 'vNodes': $descendants }, this.collapseVNodesEnd);\r\n        $descendants.find('.toggleBtn').removeClass(`${this.options.icons.collapsed} ${this.options.icons.expanded}`);\r\n      }\r\n    },\r\n    //\r\n    createGhostNode: function (event) {\r\n      var $nodeDiv = $(event.target);\r\n      var opts = this.options;\r\n      var origEvent = event.originalEvent;\r\n      var isFirefox = /firefox/.test(window.navigator.userAgent.toLowerCase());\r\n      var ghostNode, nodeCover;\r\n      if (!document.querySelector('.ghost-node')) {\r\n        ghostNode = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n        if (!ghostNode.classList) return;\r\n        ghostNode.classList.add('ghost-node');\r\n        nodeCover = document.createElementNS('http://www.w3.org/2000/svg','rect');\r\n        ghostNode.appendChild(nodeCover);\r\n        $nodeDiv.closest('.orgchart').append(ghostNode);\r\n      } else {\r\n        ghostNode = $nodeDiv.closest('.orgchart').children('.ghost-node').get(0);\r\n        nodeCover = $(ghostNode).children().get(0);\r\n      }\r\n      var transValues = $nodeDiv.closest('.orgchart').css('transform').split(',');\r\n      var isHorizontal = opts.direction === 't2b' || opts.direction === 'b2t';\r\n      var scale = Math.abs(window.parseFloat(isHorizontal ? transValues[0].slice(transValues[0].indexOf('(') + 1) : transValues[1]));\r\n      ghostNode.setAttribute('width', isHorizontal ? $nodeDiv.outerWidth(false) : $nodeDiv.outerHeight(false));\r\n      ghostNode.setAttribute('height', isHorizontal ? $nodeDiv.outerHeight(false) : $nodeDiv.outerWidth(false));\r\n      nodeCover.setAttribute('x',5 * scale);\r\n      nodeCover.setAttribute('y',5 * scale);\r\n      nodeCover.setAttribute('width', 120 * scale);\r\n      nodeCover.setAttribute('height', 40 * scale);\r\n      nodeCover.setAttribute('rx', 4 * scale);\r\n      nodeCover.setAttribute('ry', 4 * scale);\r\n      nodeCover.setAttribute('stroke-width', 1 * scale);\r\n      var xOffset = origEvent.offsetX * scale;\r\n      var yOffset = origEvent.offsetY * scale;\r\n      if (opts.direction === 'l2r') {\r\n        xOffset = origEvent.offsetY * scale;\r\n        yOffset = origEvent.offsetX * scale;\r\n      } else if (opts.direction === 'r2l') {\r\n        xOffset = $nodeDiv.outerWidth(false) - origEvent.offsetY * scale;\r\n        yOffset = origEvent.offsetX * scale;\r\n      } else if (opts.direction === 'b2t') {\r\n        xOffset = $nodeDiv.outerWidth(false) - origEvent.offsetX * scale;\r\n        yOffset = $nodeDiv.outerHeight(false) - origEvent.offsetY * scale;\r\n      }\r\n      if (isFirefox) { // hack for old version of Firefox(< 48.0)\r\n        nodeCover.setAttribute('fill', 'rgb(255, 255, 255)');\r\n        nodeCover.setAttribute('stroke', 'rgb(191, 0, 0)');\r\n        var ghostNodeWrapper = document.createElement('img');\r\n        ghostNodeWrapper.src = 'data:image/svg+xml;utf8,' + (new XMLSerializer()).serializeToString(ghostNode);\r\n        origEvent.dataTransfer.setDragImage(ghostNodeWrapper, xOffset, yOffset);\r\n      } else {\r\n        // IE/Edge do not support this, so only use it if we can\r\n        if (origEvent.dataTransfer.setDragImage)\r\n          origEvent.dataTransfer.setDragImage(ghostNode, xOffset, yOffset);\r\n      }\r\n    },\r\n    // get the level amount of a hierachy\r\n    getUpperLevel: function ($node) {\r\n      if (!$node.is('.node')) {\r\n        return 0;\r\n      }\r\n      return $node.parents('.hierarchy').length;\r\n    },\r\n    // get the level amount of a hierachy\r\n    getLowerLevel: function ($node) {\r\n      if (!$node.is('.node')) {\r\n        return 0;\r\n      }\r\n      return $node.closest('.hierarchy').find('.nodes').length + 1;\r\n    },\r\n    // get nodes in level order traversal\r\n    getLevelOrderNodes: function ($root) {\r\n      if(!$root) return [];\r\n      var queue = [];\r\n      var output = [];\r\n      queue.push($root);\r\n      while(queue.length) {\r\n        var row = [];\r\n        for(var i = 0; i < queue.length; i++) {\r\n            var cur = queue.shift();\r\n            var children = this.getChildren(cur);\r\n            if(children.length) {\r\n              queue.push(children.toArray().flat());\r\n            }\r\n            row.push($(cur));\r\n        }\r\n        output.push(row);\r\n      }\r\n      return output;\r\n    },\r\n    //\r\n    filterAllowedDropNodes: function ($dragged) {\r\n      var opts = this.options;\r\n      // what is being dragged?  a node, or something within a node?\r\n      var draggingNode = $dragged.closest('[draggable]').hasClass('node');\r\n      var $dragZone = $dragged.closest('.nodes').siblings('.node'); // parent node\r\n      var $dragHier = $dragged.closest('.hierarchy').find('.node'); // this node, and its children\r\n      this.$chart.data('dragged', $dragged)\r\n        .find('.node').each(function (index, node) {\r\n          if (!draggingNode || $dragHier.index(node) === -1) {\r\n            if (opts.dropCriteria) {\r\n              if (opts.dropCriteria($dragged, $dragZone, $(node))) {\r\n                $(node).addClass('allowedDrop');\r\n              }\r\n            } else {\r\n              $(node).addClass('allowedDrop');\r\n            }\r\n          }\r\n        });\r\n    },\r\n    //\r\n    dragstartHandler: function (event) {\r\n      event.originalEvent.dataTransfer.setData('text/html', 'hack for firefox');\r\n      // if users enable zoom or direction options\r\n      if (this.$chart.css('transform') !== 'none') {\r\n        this.createGhostNode(event);\r\n      }\r\n      this.filterAllowedDropNodes($(event.target));\r\n    },\r\n    //\r\n    dragoverHandler: function (event) {\r\n      if (!$(event.delegateTarget).is('.allowedDrop')) {\r\n        event.originalEvent.dataTransfer.dropEffect = 'none';\r\n      } else {\r\n        // default action for drag-and-drop of div is not to drop, so preventing default action for nodes which have allowedDrop class\r\n        //to fix drag and drop on IE and Edge\r\n        event.preventDefault();\r\n      }\r\n    },\r\n    //\r\n    dragendHandler: function (event) {\r\n      this.$chart.find('.allowedDrop').removeClass('allowedDrop');\r\n    },\r\n    // when user drops the node, it will be removed from original parent node and be added to new parent node\r\n    dropHandler: async function (event) {\r\n      var that = this;\r\n      var $dropZone = $(event.delegateTarget);\r\n      var $dragged = this.$chart.data('dragged');\r\n\r\n      // Pass on drops which are not nodes (since they are not our doing)\r\n      if (!$dragged.hasClass('node')) {\r\n        this.$chart.triggerHandler({ 'type': 'otherdropped.orgchart', 'draggedItem': $dragged, 'dropZone': $dropZone });\r\n        return;\r\n      }\r\n\r\n      if (!$dropZone.hasClass('allowedDrop')) {\r\n          // We are trying to drop a node into a node which isn't allowed\r\n          // IE/Edge have a habit of allowing this, so we need our own double-check\r\n          return;\r\n      }\r\n\r\n      var $dragZone = $dragged.closest('.nodes').siblings('.node');\r\n      var dropEvent = $.Event('nodedrop.orgchart');\r\n      this.$chart.trigger(dropEvent, { 'draggedNode': $dragged, 'dragZone': $dragZone, 'dropZone': $dropZone });\r\n      if (dropEvent.isDefaultPrevented()) {\r\n        return;\r\n      }\r\n      // special process for hybrid chart\r\n      var datasource = this.$chart.data('options').data;\r\n      var digger = new JSONDigger(datasource, this.$chart.data('options').nodeId, 'children');\r\n      const hybridNode = digger.findOneNode({ 'hybrid': true });\r\n      if (this.$chart.data('options').verticalLevel > 1 || hybridNode) {\r\n        var draggedNode = digger.findNodeById($dragged.data('nodeData').id);\r\n        var copy = Object.assign({}, draggedNode);\r\n        digger.removeNode(draggedNode.id);\r\n        var dropNode = digger.findNodeById($dropZone.data('nodeData').id);\r\n        if (dropNode.children) {\r\n          dropNode.children.push(copy);\r\n        } else {\r\n          dropNode.children = [copy];\r\n        }\r\n        that.init({ 'data': datasource });\r\n      } else {\r\n        // The folowing code snippets are used to process horizontal chart\r\n        // firstly, deal with the hierarchy of drop zone\r\n        if (!$dropZone.siblings('.nodes').length) { // if the drop zone is a leaf node\r\n          $dropZone.append(`<i class=\"edge verticalEdge bottomEdge ${this.options.icons.theme}\"></i>`)\r\n            .after('<ul class=\"nodes\"></ul>')\r\n            .siblings('.nodes').append($dragged.find('.horizontalEdge').remove().end().closest('.hierarchy'));\r\n          if ($dropZone.children('.title').length) {\r\n            $dropZone.children('.title').prepend(`<i class=\"${this.options.icons.theme} ${this.$chart.data('options').icons.parentNode} parentNodeSymbol\"></i>`);\r\n          }\r\n        } else {\r\n          var horizontalEdges = `<i class=\"edge horizontalEdge rightEdge ${this.options.icons.theme}\"></i><i class=\"edge horizontalEdge leftEdge ${this.options.icons.theme}\"></i>`;\r\n          if (!$dragged.find('.horizontalEdge').length) {\r\n            $dragged.append(horizontalEdges);\r\n          }\r\n          $dropZone.siblings('.nodes').append($dragged.closest('.hierarchy'));\r\n          var $dropSibs = $dragged.closest('.hierarchy').siblings().find('.node:first');\r\n          if ($dropSibs.length === 1) {\r\n            $dropSibs.append(horizontalEdges);\r\n          }\r\n        }\r\n        // secondly, deal with the hierarchy of dragged node\r\n        if ($dragZone.siblings('.nodes').children('.hierarchy').length === 1) { // if there is only one sibling node left\r\n          $dragZone.siblings('.nodes').children('.hierarchy').find('.node:first')\r\n            .find('.horizontalEdge').remove();\r\n        } else if ($dragZone.siblings('.nodes').children('.hierarchy').length === 0) {\r\n          $dragZone.find('.bottomEdge, .parentNodeSymbol').remove()\r\n            .end().siblings('.nodes').remove();\r\n        }\r\n      }\r\n    },\r\n    //\r\n    touchstartHandler: function (event) {\r\n      if (this.touchHandled)\r\n        return;\r\n\r\n      if (event.touches && event.touches.length > 1)\r\n        return;\r\n\r\n      this.touchHandled = true;\r\n      this.touchMoved = false; // this is so we can work out later if this was a 'press' or a 'drag' touch\r\n      event.preventDefault();\r\n    },\r\n    //\r\n    touchmoveHandler: function (event) {\r\n      if (!this.touchHandled)\r\n        return;\r\n\r\n      if (event.touches && event.touches.length > 1)\r\n        return;\r\n\r\n      event.preventDefault();\r\n\r\n      if (!this.touchMoved) {\r\n        // we do not bother with createGhostNode (dragstart does) since the touch event does not have a dataTransfer property\r\n        this.filterAllowedDropNodes($(event.currentTarget));  // will also set 'this.$chart.data('dragged')' for us\r\n        // create an image which can be used to illustrate the drag (our own createGhostNode)\r\n        this.touchDragImage = this.createDragImage(event, this.$chart.data('dragged')[0]);\r\n      }\r\n      this.touchMoved = true;\r\n\r\n      // move our dragimage so it follows our finger\r\n      this.moveDragImage(event, this.touchDragImage);\r\n\r\n      var $touching = $(document.elementFromPoint(event.touches[0].clientX, event.touches[0].clientY));\r\n      var $touchingNodes = $touching.closest('div.node');\r\n      if ($touchingNodes.length > 0) {\r\n        var touchingNodeElement = $touchingNodes[0];\r\n        if ($touchingNodes.is('.allowedDrop')) {\r\n          this.touchTargetNode = touchingNodeElement;\r\n        }\r\n        else {\r\n          this.touchTargetNode = null;\r\n        }\r\n      }\r\n      else {\r\n        this.touchTargetNode = null;\r\n      }\r\n    },\r\n    //\r\n    touchendHandler: function (event) {\r\n      if (!this.touchHandled) {\r\n          return;\r\n      }\r\n      this.destroyDragImage();\r\n      if (this.touchMoved) {\r\n          // we've had movement, so this was a 'drag' touch\r\n          if (this.touchTargetNode) {\r\n              var fakeEventForDropHandler = { delegateTarget: this.touchTargetNode };\r\n              this.dropHandler(fakeEventForDropHandler);\r\n              this.touchTargetNode = null;\r\n          }\r\n          this.dragendHandler(event);\r\n      }\r\n      else {\r\n          // we did not move, so this was a 'press' touch (fake a click)\r\n          var firstTouch = event.changedTouches[0];\r\n          var fakeMouseClickEvent = document.createEvent('MouseEvents');\r\n          fakeMouseClickEvent.initMouseEvent('click', true, true, window, 1, firstTouch.screenX, firstTouch.screenY, firstTouch.clientX, firstTouch.clientY, event.ctrlKey, event.altKey, event.shiftKey, event.metaKey, 0, null);\r\n          event.target.dispatchEvent(fakeMouseClickEvent);\r\n      }\r\n      this.touchHandled = false;\r\n    },\r\n    //\r\n    createDragImage: function (event, source) {\r\n      var dragImage = source.cloneNode(true);\r\n      this.copyStyle(source, dragImage);\r\n      dragImage.style.top = dragImage.style.left = '-9999px';\r\n      var sourceRectangle = source.getBoundingClientRect();\r\n      var sourcePoint = this.getTouchPoint(event);\r\n      this.touchDragImageOffset = { x: sourcePoint.x - sourceRectangle.left, y: sourcePoint.y - sourceRectangle.top };\r\n      dragImage.style.opacity = '0.5';\r\n      document.body.appendChild(dragImage);\r\n      return dragImage;\r\n    },\r\n    //\r\n    destroyDragImage: function () {\r\n      if (this.touchDragImage && this.touchDragImage.parentElement)\r\n        this.touchDragImage.parentElement.removeChild(this.touchDragImage);\r\n      this.touchDragImageOffset = null;\r\n      this.touchDragImage = null;\r\n    },\r\n    //\r\n    copyStyle: function (src, dst) {\r\n      // remove potentially troublesome attributes\r\n      var badAttributes = ['id', 'class', 'style', 'draggable'];\r\n      badAttributes.forEach(function (att) {\r\n          dst.removeAttribute(att);\r\n      });\r\n      // copy canvas content\r\n      if (src instanceof HTMLCanvasElement) {\r\n        var cSrc = src, cDst = dst;\r\n        cDst.width = cSrc.width;\r\n        cDst.height = cSrc.height;\r\n        cDst.getContext('2d').drawImage(cSrc, 0, 0);\r\n      }\r\n      // copy style (without transitions)\r\n      var cs = getComputedStyle(src);\r\n      for (var i = 0; i < cs.length; i++) {\r\n        var key = cs[i];\r\n        if (key.indexOf('transition') < 0) {\r\n          dst.style[key] = cs[key];\r\n        }\r\n      }\r\n      dst.style.pointerEvents = 'none';\r\n      // and repeat for all children\r\n      for (var i = 0; i < src.children.length; i++) {\r\n        this.copyStyle(src.children[i], dst.children[i]);\r\n      }\r\n    },\r\n    //\r\n    getTouchPoint: function (event) {\r\n      if (event && event.touches) {\r\n        event = event.touches[0];\r\n      }\r\n      return {\r\n        x: event.clientX,\r\n        y: event.clientY\r\n      };\r\n    },\r\n    //\r\n    moveDragImage: function (event, image) {\r\n      if (!event || !image)\r\n        return;\r\n      var orgChartMaster = this;\r\n      requestAnimationFrame(function () {\r\n        var pt = orgChartMaster.getTouchPoint(event);\r\n        var s = image.style;\r\n        s.position = 'absolute';\r\n        s.pointerEvents = 'none';\r\n        s.zIndex = '999999';\r\n        if (orgChartMaster.touchDragImageOffset) {\r\n            s.left = Math.round(pt.x - orgChartMaster.touchDragImageOffset.x) + 'px';\r\n            s.top = Math.round(pt.y - orgChartMaster.touchDragImageOffset.y) + 'px';\r\n        }\r\n      });\r\n    },\r\n    //\r\n    bindDragDrop: function ($node) {\r\n      $node.on('dragstart', this.dragstartHandler.bind(this))\r\n        .on('dragover', this.dragoverHandler.bind(this))\r\n        .on('dragend', this.dragendHandler.bind(this))\r\n        .on('drop', this.dropHandler.bind(this))\r\n        .on('touchstart', this.touchstartHandler.bind(this))\r\n        .on('touchmove', this.touchmoveHandler.bind(this))\r\n        .on('touchend', this.touchendHandler.bind(this));\r\n    },\r\n    // create node\r\n    createNode: function (data) {\r\n      var that = this;\r\n      var opts = this.options;\r\n      var level = data.level;\r\n      if (data.children && data[opts.nodeId]) {\r\n        $.each(data.children, function (index, child) {\r\n          child.parentId = data[opts.nodeId]\r\n        });\r\n      }\r\n      // construct the content of node\r\n      var $nodeDiv = $('<div' + (opts.draggable ? ' draggable=\"true\"' : '') + (data[opts.nodeId] ? ' id=\"' + data[opts.nodeId] + '\"' : '') + (data.parentId ? ' data-parent=\"' + data.parentId + '\"' : '') + '>')\r\n        .addClass('node ' + (data.className || '') +  (level > opts.visibleLevel ? ' slide-up' : ''));\r\n      if (opts.nodeTemplate) {\r\n        $nodeDiv.append(opts.nodeTemplate(data));\r\n      } else {\r\n        $nodeDiv.append('<div class=\"title\">' + data[opts.nodeTitle] + '</div>')\r\n          .append(typeof opts.nodeContent !== 'undefined' ? '<div class=\"content\">' + (data[opts.nodeContent] || '') + '</div>' : '');\r\n      }\r\n      //\r\n      var nodeData = $.extend({}, data);\r\n      delete nodeData.children;\r\n      $nodeDiv.data('nodeData', nodeData);\r\n      // append 4 direction arrows or expand/collapse buttons or reset buttons\r\n      var flags = data.relationship || '';\r\n      if ((opts.verticalLevel && level >= opts.verticalLevel) || data.vertical) {\r\n        if (Number(flags.substr(2,1))) {\r\n          $nodeDiv.append(`<i class=\"toggleBtn ${opts.icons.theme}\"></i>`)\r\n            .children('.title').prepend(`<i class=\"${opts.icons.theme} ${opts.icons.parentNode} parentNodeSymbol\"></i>`);\r\n        }\r\n      } else if (data.hybrid) {\r\n        if (Number(flags.substr(2,1))) {\r\n          $nodeDiv.append(`<i class=\"edge verticalEdge bottomEdge ${opts.icons.theme}\"></i>`)\r\n            .children('.title').prepend(`<i class=\"${opts.icons.theme} ${opts.icons.parentNode} parentNodeSymbol\"></i>`);\r\n        }\r\n      } else if (data.compact) {\r\n        $nodeDiv.css('grid-template-columns', `repeat(${Math.floor(Math.sqrt(data.children.length + 1))}, auto)`);\r\n        if (Number(flags.substr(2,1))) {\r\n          $nodeDiv.append(`\r\n            <i class=\"${opts.icons.theme} ${opts.icons.backToCompact} backToCompactSymbol hidden\"></i>\r\n            <i class=\"${opts.icons.theme} ${opts.icons.backToLoose} backToLooseSymbol\"></i>\r\n            `)\r\n            .children('.title').prepend(`<i class=\"${opts.icons.theme} ${opts.icons.parentNode} parentNodeSymbol\"></i>`);\r\n        }\r\n      } else if (data.associatedCompact) {\r\n   \r\n      } else {\r\n        if (Number(flags.substr(0,1))) {\r\n          $nodeDiv.append(`<i class=\"edge verticalEdge topEdge ${opts.icons.theme}\"></i>`);\r\n        }\r\n        if(Number(flags.substr(1,1))) {\r\n          $nodeDiv.append(`<i class=\"edge horizontalEdge rightEdge ${opts.icons.theme}\"></i><i class=\"edge horizontalEdge leftEdge ${opts.icons.theme}\"></i>`);\r\n        }\r\n        if(Number(flags.substr(2,1))) {\r\n          $nodeDiv.append(`<i class=\"edge verticalEdge bottomEdge ${opts.icons.theme}\"></i>`)\r\n            .children('.title').prepend(`<i class=\"${opts.icons.theme} ${opts.icons.parentNode} parentNodeSymbol\"></i>`);\r\n        }\r\n      }\r\n\r\n      $nodeDiv.on('mouseenter mouseleave', this.nodeEnterLeaveHandler.bind(this));\r\n      $nodeDiv.on('click', this.nodeClickHandler.bind(this));\r\n      $nodeDiv.on('click', '.topEdge', this.topEdgeClickHandler.bind(this));\r\n      $nodeDiv.on('click', '.bottomEdge', this.bottomEdgeClickHandler.bind(this));\r\n      $nodeDiv.on('click', '.leftEdge, .rightEdge', this.hEdgeClickHandler.bind(this));\r\n      $nodeDiv.on('click', '.toggleBtn', this.toggleVNodes.bind(this));\r\n      $nodeDiv.on('click', '> .backToCompactSymbol',this.backToCompactHandler.bind(this));\r\n      $nodeDiv.on('click', '> .backToLooseSymbol',this.backToLooseHandler.bind(this));\r\n\r\n      if (opts.draggable) {\r\n        this.bindDragDrop($nodeDiv);\r\n        this.touchHandled = false;\r\n        this.touchMoved = false;\r\n        this.touchTargetNode = null;\r\n      }\r\n      // allow user to append dom modification after finishing node create of orgchart\r\n      if (opts.createNode) {\r\n        opts.createNode($nodeDiv, data);\r\n      }\r\n\r\n      return $nodeDiv;\r\n    },\r\n    // recursively build the tree\r\n    buildHierarchy: function ($appendTo, data) {\r\n      var that = this;\r\n      var opts = this.options;\r\n      var level = 0;\r\n      var $nodeDiv;\r\n      if (data.level) {\r\n        level = data.level;\r\n      } else {\r\n        level = data.level = $appendTo.parentsUntil('.orgchart', '.nodes').length;\r\n      }\r\n      // Construct the node\r\n      if (Object.keys(data).length > 2) {\r\n        $nodeDiv = this.createNode(data);\r\n        $appendTo.append($nodeDiv);\r\n      }\r\n      // Construct the \"inferior nodes\"\r\n      if (data.children && data.children.length) {\r\n        var isHidden = level + 1 > opts.visibleLevel || (data.collapsed !== undefined && data.collapsed);\r\n        var $nodesLayer;\r\n        if ((opts.verticalLevel && (level + 1) >= opts.verticalLevel) || data.hybrid) {\r\n          $nodesLayer = $('<ul class=\"nodes\">');\r\n          if (isHidden && (opts.verticalLevel && (level + 1) >= opts.verticalLevel)) {\r\n            $nodesLayer.addClass('hidden');\r\n          }\r\n          if (((opts.verticalLevel && level + 1 === opts.verticalLevel) || data.hybrid)\r\n            && !$appendTo.closest('.vertical').length) {\r\n              $appendTo.append($nodesLayer.addClass('vertical'));\r\n          } else {\r\n            $appendTo.append($nodesLayer);\r\n          }\r\n        } else if (data.compact) {\r\n          $nodeDiv.addClass('compact');\r\n        } else {\r\n          $nodesLayer = $('<ul class=\"nodes' + (isHidden ? ' hidden' : '') + '\">');\r\n          if (Object.keys(data).length === 2) {\r\n            $appendTo.append($nodesLayer);\r\n          } else {\r\n            if (isHidden) {\r\n              $appendTo.addClass('isChildrenCollapsed');\r\n            }\r\n            $appendTo.append($nodesLayer);\r\n          }\r\n        }\r\n        // recurse through children nodes\r\n        $.each(data.children, function () {\r\n          this.level = level + 1;\r\n          if (data.compact) {\r\n            that.buildHierarchy($nodeDiv, this);\r\n          } else {\r\n            var $nodeCell = $('<li class=\"hierarchy\">');\r\n            $nodesLayer.append($nodeCell);\r\n            that.buildHierarchy($nodeCell, this);\r\n          }\r\n        });\r\n      }\r\n    },\r\n    // build the child nodes of specific node\r\n    buildChildNode: function ($appendTo, data) {\r\n      this.buildHierarchy($appendTo, { 'children': data });\r\n    },\r\n    // exposed method\r\n    addChildren: function ($node, data) {\r\n      this.buildChildNode($node.closest('.hierarchy'), data);\r\n      if (!$node.find('.parentNodeSymbol').length) {\r\n        $node.children('.title').prepend(`<i class=\"${this.options.icons.theme} ${this.options.icons.parentNode} parentNodeSymbol\"></i>`);\r\n      }\r\n      if ($node.closest('.nodes.vertical').length) {\r\n        if (!$node.children('.toggleBtn').length) {\r\n          $node.append(`<i class=\"toggleBtn ${this.options.icons.theme}\"></i>`);\r\n        }\r\n      } else {\r\n        if (!$node.children('.bottomEdge').length) {\r\n          $node.append(`<i class=\"edge verticalEdge bottomEdge ${this.options.icons.theme}\"></i>`);\r\n        }\r\n      }\r\n      if (this.isInAction($node)) {\r\n        this.switchVerticalArrow($node.children('.bottomEdge'));\r\n      }\r\n    },\r\n    // build the parent node of specific node\r\n    buildParentNode: function ($currentRoot, data) {\r\n      data.relationship = data.relationship || '001';\r\n      var $newRootWrapper = $('<ul class=\"nodes\"><li class=\"hierarchy\"></li></ul>')\r\n        .find('.hierarchy').append(this.createNode(data)).end();\r\n      this.$chart.prepend($newRootWrapper)\r\n        .find('.hierarchy:first').append($currentRoot.closest('ul').addClass('nodes'));\r\n    },\r\n    // exposed method\r\n    addParent: function ($currentRoot, data) {\r\n      this.buildParentNode($currentRoot, data);\r\n      if (!$currentRoot.children('.topEdge').length) {\r\n        $currentRoot.children('.title').after(`<i class=\"edge verticalEdge topEdge ${this.options.icons.theme}\"></i>`);\r\n      }\r\n      if (this.isInAction($currentRoot)) {\r\n        this.switchVerticalArrow($currentRoot.children('.topEdge'));\r\n      }\r\n    },\r\n    // build the sibling nodes of specific node\r\n    buildSiblingNode: function ($nodeChart, data) {\r\n      var newSiblingCount = $.isArray(data) ? data.length : data.children.length;\r\n      var existingSibligCount = $nodeChart.parent().is('.nodes') ? $nodeChart.siblings().length + 1 : 1;\r\n      var siblingCount = existingSibligCount + newSiblingCount;\r\n      var insertPostion = (siblingCount > 1) ? Math.floor(siblingCount/2 - 1) : 0;\r\n      // just build the sibling nodes for the specific node\r\n      if ($nodeChart.closest('.nodes').parent().is('.hierarchy')) {\r\n        this.buildChildNode($nodeChart.parent().closest('.hierarchy'), data);\r\n        var $siblings = $nodeChart.parent().closest('.hierarchy').children('.nodes:last').children('.hierarchy');\r\n        if (existingSibligCount > 1) {\r\n          $siblings.eq(0).before($nodeChart.siblings().addBack().unwrap());\r\n        } else {\r\n          $siblings.eq(insertPostion).after($nodeChart.unwrap());\r\n        }\r\n      } else { // build the sibling nodes and parent node for the specific ndoe\r\n        this.buildHierarchy($nodeChart.parent().prepend($('<li class=\"hierarchy\">')).children('.hierarchy:first'), data);\r\n        $nodeChart.prevAll('.hierarchy').children('.nodes').children().eq(insertPostion).after($nodeChart);\r\n      }\r\n    },\r\n    //\r\n    addSiblings: function ($node, data) {\r\n      this.buildSiblingNode($node.closest('.hierarchy'), data);\r\n      $node.closest('.nodes').data('siblingsLoaded', true);\r\n      if (!$node.children('.leftEdge').length) {\r\n        $node.children('.topEdge').after(`<i class=\"edge horizontalEdge rightEdge ${this.options.icons.theme}\"></i><i class=\"edge horizontalEdge leftEdge ${this.options.icons.theme}\"></i>`);\r\n      }\r\n      if (this.isInAction($node)) {\r\n        this.switchHorizontalArrow($node);\r\n        $node.children('.topEdge').removeClass(this.options.icons.expandToUp).addClass(this.options.icons.collapseToDown);\r\n      }\r\n    },\r\n    // remove node and its descendent nodes\r\n    removeNodes: function ($node) {\r\n      var $wrapper = $node.closest('.hierarchy').parent();\r\n      if ($wrapper.parent().is('.hierarchy')) {\r\n        if (this.getNodeState($node, 'siblings').exist) {\r\n          $node.closest('.hierarchy').remove();\r\n          if ($wrapper.children().length === 1) {\r\n            $wrapper.find('.node:first .horizontalEdge').remove();\r\n          }\r\n        } else {\r\n          $wrapper.siblings('.node').find('.bottomEdge').remove()\r\n            .end().end().remove();\r\n        }\r\n      } else { // if $node is root node\r\n        $wrapper.closest('.orgchart').remove();\r\n      }\r\n    },\r\n    //\r\n    hideDropZones: function () {\r\n      // Remove all the 'this is a drop zone' indicators\r\n      var orgChartObj = this;\r\n      orgChartObj.$chart.find('.allowedDrop')\r\n        .removeClass('allowedDrop');\r\n    },\r\n    //\r\n    showDropZones: function (dragged) {\r\n      // Highlight all the 'drop zones', and set dragged, so that the drop/enter can work out what happens later\r\n      // TODO: This assumes all nodes are droppable: it doesn't run the custom isDroppable function - it should!\r\n      var orgChartObj = this;\r\n      orgChartObj.$chart.find('.node')\r\n        .each(function (index, node) {\r\n          $(node).addClass('allowedDrop');\r\n        });\r\n      orgChartObj.$chart.data('dragged', $(dragged));\r\n    },\r\n    //\r\n    processExternalDrop: function (dropZone, dragged) {\r\n      // Allow an external drop event to be handled by one of our nodes\r\n      if (dragged) {\r\n        this.$chart.data('dragged', $(dragged));\r\n      }\r\n      var droppedOnNode = dropZone.closest('.node');\r\n      // would like to just call 'dropZoneHandler', but I can't reach it from here\r\n      // instead raise a drop event on the node element\r\n      droppedOnNode.triggerHandler({ 'type': 'drop' });\r\n    },\r\n    //\r\n    exportPDF: function(canvas, exportFilename){\r\n      var doc = {};\r\n      var docWidth = Math.floor(canvas.width);\r\n      var docHeight = Math.floor(canvas.height);\r\n      if (!window.jsPDF) {\r\n        window.jsPDF = window.jspdf.jsPDF;\r\n      }\r\n\r\n      if (docWidth > docHeight) {\r\n        doc = new jsPDF({\r\n          orientation: 'landscape',\r\n          unit: 'px',\r\n          format: [docWidth, docHeight]\r\n        });\r\n      } else {\r\n        doc = new jsPDF({\r\n          orientation: 'portrait',\r\n          unit: 'px',\r\n          format: [docHeight, docWidth]\r\n        });\r\n      }\r\n      doc.addImage(canvas.toDataURL(), 'png', 0, 0);\r\n      doc.save(exportFilename + '.pdf');\r\n    },\r\n    //\r\n    exportPNG: function(canvas, exportFilename){\r\n      var that = this;\r\n      var isWebkit = 'WebkitAppearance' in document.documentElement.style;\r\n      var isFf = !!window.sidebar;\r\n      var isEdge = navigator.appName === 'Microsoft Internet Explorer' || (navigator.appName === \"Netscape\" && navigator.appVersion.indexOf('Edge') > -1);\r\n      var $chartContainer = this.$chartContainer;\r\n\r\n      if ((!isWebkit && !isFf) || isEdge) {\r\n        window.navigator.msSaveBlob(canvas.msToBlob(), exportFilename + '.png');\r\n      } else {\r\n        var selector = '.download-btn' + (that.options.chartClass !== '' ? '.' + that.options.chartClass : '');\r\n\r\n        if (!$chartContainer.find(selector).length) {\r\n          $chartContainer.append('<a class=\"download-btn' + (that.options.chartClass !== '' ? ' ' + that.options.chartClass : '') + '\"'\r\n                                 + ' download=\"' + exportFilename + '.png\"></a>');\r\n        }\r\n\r\n        $chartContainer.find(selector).attr('href', canvas.toDataURL())[0].click();\r\n      }\r\n    },\r\n    //\r\n    export: function (exportFilename, exportFileextension) {\r\n      var that = this;\r\n      exportFilename = (typeof exportFilename !== 'undefined') ?  exportFilename : this.options.exportFilename;\r\n      exportFileextension = (typeof exportFileextension !== 'undefined') ?  exportFileextension : this.options.exportFileextension;\r\n      if ($(this).children('.spinner').length) {\r\n        return false;\r\n      }\r\n      var $chartContainer = this.$chartContainer;\r\n      var $mask = $chartContainer.find('.mask');\r\n      if (!$mask.length) {\r\n        $chartContainer.append(`<div class=\"mask\"><i class=\"${this.options.icons.theme} ${this.options.icons.spinner} spinner\"></i></div>`);\r\n      } else {\r\n        $mask.removeClass('hidden');\r\n      }\r\n      var sourceChart = $chartContainer.addClass('canvasContainer').find('.orgchart:not(\".hidden\")').get(0);\r\n      var flag = that.options.direction === 'l2r' || that.options.direction === 'r2l';\r\n      html2canvas(sourceChart, {\r\n        'width': flag ? sourceChart.clientHeight : sourceChart.clientWidth,\r\n        'height': flag ? sourceChart.clientWidth : sourceChart.clientHeight,\r\n        'onclone': function (cloneDoc) {\r\n          $(cloneDoc).find('.canvasContainer').css('overflow', 'visible')\r\n            .find('.orgchart:not(\".hidden\"):first').css('transform', '');\r\n        }\r\n      })\r\n      .then(function (canvas) {\r\n        $chartContainer.find('.mask').addClass('hidden');\r\n\r\n        if (exportFileextension.toLowerCase() === 'pdf') {\r\n          that.exportPDF(canvas, exportFilename);\r\n        } else {\r\n          that.exportPNG(canvas, exportFilename);\r\n        }\r\n\r\n        $chartContainer.removeClass('canvasContainer');\r\n      }, function () {\r\n        $chartContainer.removeClass('canvasContainer');\r\n      });\r\n    }\r\n  };\r\n\r\n  $.fn.orgchart = function (opts) {\r\n    return new OrgChart(this, opts).init();\r\n  };\r\n\r\n}));\r\n"],"names":["factory","module","exports","require","window","document","jQuery","$","undefined","OrgChart","elem","opts","this","$chartContainer","defaultOptions","icons","theme","parentNode","expandToUp","collapseToDown","collapseToLeft","expandToRight","backToCompact","backToLoose","collapsed","expanded","spinner","nodeTitle","nodeId","toggleSiblingsResp","visibleLevel","chartClass","exportButton","exportButtonName","exportFilename","exportFileextension","draggable","direction","pan","zoom","zoominLimit","zoomoutLimit","prototype","init","options","extend","data","$chart","remove","class","click","event","target","closest","length","find","removeClass","$root","MutationObserver","triggerInitEvent","append","buildHierarchy","buildJsonDS","children","relationship","attachRel","attachExportButton","bindPan","bindZoom","handleCompactNodes","each","index","node","addClass","parents","that","mo","mutations","disconnect","initTime","i","j","addedNodes","classList","contains","initCompleted","initEvent","Event","trigger","observe","childList","triggerShowEvent","$target","rel","triggerHideEvent","$exportBtn","text","e","preventDefault","export","after","setOptions","val","unbindPan","unbindZoom","panStartHandler","delegateTarget","touches","css","temp","lastX","lastY","lastTf","startX","split","indexOf","parseInt","startY","targetTouches","pageX","pageY","on","newX","newY","matrix","join","panEndHandler","chart","off","zoomWheelHandler","oc","newScale","originalEvent","deltaY","setChartScale","zoomStartHandler","dist","getPinchDist","zoomingHandler","zoomEndHandler","diff","Math","sqrt","clientX","clientY","targetScale","abs","parseFloat","$li","subObj","name","contents","eq","trim","parent","is","siblings","key","value","push","flags","compact","constructor","Function","forEach","item","hybrid","vertical","associatedCompact","loopChart","includeNodeData","$node","id","getHierarchy","valid","getNodeState","relation","isVerticalNode","exist","visible","getParent","getRelatedNodes","getChildren","getSiblings","hideParentEnd","hideParent","$parent","hideSiblings","one","showParentEnd","isInAction","switchVerticalArrow","showParent","repaint","bind","stopAjax","$nodeLevel","isVisibleNode","isCompactDescendant","hideChildrenEnd","animatedNodes","hideChildren","$lowerLevel","$animatedNodes","filter","not","get","lowerLevel","showChildrenEnd","showChildren","$levels","isVerticalDesc","hideSiblingsEnd","$nodeContainer","nodeContainer","$siblings","prevAll","nextAll","end","switchHorizontalArrow","showSiblingsEnd","visibleNodes","showRelatedParentEnd","showSiblings","$upperLevel","$visibleNodes","startLoading","$edge","prop","endLoading","removeAttr","some","attr","icon","$arrow","toggleClass","sibsVisible","ajaxURL","$prevSib","prev","$nextSib","next","$sibs","style","offsetWidth","nodeEnterLeaveHandler","$topEdge","$bottomEdge","$leftEdge","flag","$toggleBtn","type","nodeClickHandler","addAncestors","parentId","slice","wrapAll","appendTo","addDescendants","$descendants","HideFirstParentEnd","topEdge","topEdgeClickHandler","parentState","bottomEdgeClickHandler","childrenState","$children","hEdgeClickHandler","$hEdge","siblingsState","backToCompactHandler","backToLooseHandler","expandVNodesEnd","vNodes","collapseVNodesEnd","toggleVNodes","$descWrapper","createGhostNode","ghostNode","nodeCover","$nodeDiv","origEvent","isFirefox","test","navigator","userAgent","toLowerCase","querySelector","createElementNS","add","appendChild","transValues","isHorizontal","scale","xOffset","setAttribute","outerWidth","outerHeight","offsetX","yOffset","offsetY","ghostNodeWrapper","createElement","src","XMLSerializer","serializeToString","dataTransfer","setDragImage","getUpperLevel","getLowerLevel","getLevelOrderNodes","queue","output","row","cur","shift","toArray","flat","filterAllowedDropNodes","$dragged","draggingNode","hasClass","$dragZone","$dragHier","dropCriteria","dragstartHandler","setData","dragoverHandler","dropEffect","dragendHandler","dropHandler","async","datasource","copy","horizontalEdges","$dropSibs","$dropZone","dropEvent","draggedNode","dragZone","dropZone","isDefaultPrevented","hybridNode","digger","JSONDigger","findOneNode","verticalLevel","findNodeById","Object","assign","removeNode","dropNode","prepend","triggerHandler","draggedItem","touchstartHandler","touchHandled","touchMoved","touchmoveHandler","touchingNodeElement","currentTarget","touchDragImage","createDragImage","moveDragImage","$touchingNodes","elementFromPoint","touchTargetNode","touchendHandler","firstTouch","fakeMouseClickEvent","destroyDragImage","fakeEventForDropHandler","changedTouches","createEvent","initMouseEvent","screenX","screenY","ctrlKey","altKey","shiftKey","metaKey","dispatchEvent","source","dragImage","cloneNode","sourceRectangle","copyStyle","top","left","getBoundingClientRect","sourcePoint","getTouchPoint","touchDragImageOffset","x","y","opacity","body","parentElement","removeChild","dst","att","removeAttribute","HTMLCanvasElement","cDst","width","cSrc","height","getContext","drawImage","cs","getComputedStyle","pointerEvents","image","orgChartMaster","requestAnimationFrame","pt","s","position","zIndex","round","bindDragDrop","createNode","level","child","className","nodeData","nodeTemplate","nodeContent","Number","substr","floor","$appendTo","isHidden","$nodesLayer","parentsUntil","keys","$nodeCell","buildChildNode","addChildren","buildParentNode","$currentRoot","$newRootWrapper","addParent","buildSiblingNode","$nodeChart","newSiblingCount","isArray","existingSibligCount","siblingCount","insertPostion","before","addBack","unwrap","addSiblings","removeNodes","$wrapper","hideDropZones","showDropZones","dragged","processExternalDrop","exportPDF","canvas","doc","docWidth","docHeight","jsPDF","jspdf","orientation","unit","format","addImage","toDataURL","save","exportPNG","isWebkit","documentElement","isFf","sidebar","isEdge","appName","appVersion","msSaveBlob","msToBlob","selector","$mask","sourceChart","html2canvas","clientHeight","clientWidth","onclone","cloneDoc","then","fn","orgchart"],"mappings":"AAUA,aAEA,CAAC,SAAUA,GACa,UAAlB,OAAOC,QAAiD,UAA1B,OAAOA,OAAOC,QAC9CF,EAAQG,QAAQ,QAAQ,EAAGC,OAAQC,QAAQ,EAE3CL,EAAQM,OAAQF,OAAQC,QAAQ,CAEpC,EAAE,SAAUE,EAAGH,EAAQC,EAAUG,GAChB,SAAXC,EAAqBC,EAAMC,GAC7BC,KAAKC,gBAAkBN,EAAEG,CAAI,EAC7BE,KAAKD,KAAOA,EACZC,KAAKE,eAAiB,CACpBC,MAAS,CACPC,MAAS,MACTC,WAAc,WACdC,WAAc,iBACdC,eAAkB,mBAClBC,eAAkB,mBAClBC,cAAiB,oBACjBC,cAAiB,sBACjBC,YAAe,0BACfC,UAAa,kBACbC,SAAY,mBACZC,QAAW,aACb,EACAC,UAAa,OACbC,OAAU,KACVC,mBAAsB,CAAA,EACtBC,aAAgB,IAChBC,WAAc,GACdC,aAAgB,CAAA,EAChBC,iBAAoB,SACpBC,eAAkB,WAClBC,oBAAuB,MACvBC,UAAa,CAAA,EACbC,UAAa,MACbC,IAAO,CAAA,EACPC,KAAQ,CAAA,EACRC,YAAe,EACfC,aAAgB,EAClB,CACF,CAEAhC,EAASiC,UAAY,CAEnBC,KAAM,SAAUhC,GAEdC,KAAKgC,QAAUrC,EAAEsC,OAAO,GAAIjC,KAAKE,eAAgBF,KAAKD,KAAMA,CAAI,EADhE,IAGIE,EAAkBD,KAAKC,gBAIvBiC,GAHAlC,KAAKmC,QACPnC,KAAKmC,OAAOC,OAAO,EAEVpC,KAAKgC,QAAQE,MACpBC,EAASnC,KAAKmC,OAASxC,EAAE,QAAS,CACpCuC,KAAQ,CAAEF,QAAWhC,KAAKgC,OAAQ,EAClCK,MAAS,YAA0C,KAA5BrC,KAAKgC,QAAQb,WAAoB,IAAMnB,KAAKgC,QAAQb,WAAa,KAAkC,QAA3BnB,KAAKgC,QAAQP,UAAsB,IAAMzB,KAAKgC,QAAQP,UAAY,IACjKa,MAAS,SAASC,GACX5C,EAAE4C,EAAMC,MAAM,EAAEC,QAAQ,OAAO,EAAEC,QACpCP,EAAOQ,KAAK,eAAe,EAAEC,YAAY,SAAS,CAEtD,CACF,CAAC,EAIGC,GAH4B,aAA5B,OAAOC,kBACT9C,KAAK+C,iBAAiB,EAEZZ,EAAOa,OAAOrD,EAAE,oDAAoD,CAAC,EAAEgD,KAAK,YAAY,GA2BpG,OAzBMT,aAAgBvC,EAClBK,KAAKiD,eAAeJ,EAAO7C,KAAKkD,YAAYhB,EAAKiB,SAAS,CAAC,EAAG,EAAGnD,KAAKgC,OAAO,EAEzEE,EAAKkB,aACPpD,KAAKiD,eAAeJ,EAAOX,CAAI,EAE/BlC,KAAKiD,eAAeJ,EAAO7C,KAAKqD,UAAUnB,EAAM,IAAI,CAAC,EAI3DjC,EAAgB+C,OAAOb,CAAM,EAGzBnC,KAAKgC,QAAQZ,cAAgB,CAACzB,EAAE,gBAAgB,EAAE+C,QACpD1C,KAAKsD,mBAAmB,EAGtBtD,KAAKgC,QAAQN,KACf1B,KAAKuD,QAAQ,EAGXvD,KAAKgC,QAAQL,MACf3B,KAAKwD,SAAS,EAGTxD,IACT,EACAyD,mBAAoB,WAElBzD,KAAKmC,OAAOQ,KAAK,eAAe,EAC7Be,KAAK,CAACC,EAAOC,KACZjE,EAAEiE,CAAI,EAAEC,SAASlE,EAAEiE,CAAI,EAAEE,QAAQ,UAAU,EAAEpB,OAAS,GAAM,EAAI,OAAS,KAAK,CAChF,CAAC,CAQL,EAEAK,iBAAkB,WAChB,IAAIgB,EAAO/D,KACPgE,EAAK,IAAIlB,iBAAiB,SAAUmB,GACtCD,EAAGE,WAAW,EACdC,EACA,IAAK,IAAIC,EAAI,EAAGA,EAAIH,EAAUvB,OAAQ0B,CAAC,GACrC,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAUG,GAAGE,WAAW5B,OAAQ2B,CAAC,GACnD,GAAIJ,EAAUG,GAAGE,WAAWD,GAAGE,UAAUC,SAAS,UAAU,EAAG,CAC7DT,EAAKN,mBAAmB,EACpBM,EAAK/B,QAAQyC,eAAuD,YAAtC,OAAOV,EAAK/B,QAAQyC,eACpDV,EAAK/B,QAAQyC,cAAcV,EAAK5B,MAAM,EAExC,IAAIuC,EAAY/E,EAAEgF,MAAM,eAAe,EACvCZ,EAAK5B,OAAOyC,QAAQF,CAAS,EAC7B,MAAMP,CACR,CAGN,CAAC,EACDH,EAAGa,QAAQ7E,KAAKC,gBAAgB,GAAI,CAAE6E,UAAW,CAAA,CAAK,CAAC,CACzD,EACAC,iBAAkB,SAAUC,EAASC,GAC/BP,EAAY/E,EAAEgF,MAAM,QAAUM,EAAM,WAAW,EACnDD,EAAQJ,QAAQF,CAAS,CAC3B,EACAQ,iBAAkB,SAAUF,EAASC,GAC/BP,EAAY/E,EAAEgF,MAAM,QAAUM,EAAM,WAAW,EACnDD,EAAQJ,QAAQF,CAAS,CAC3B,EAEApB,mBAAoB,WAClB,IAAIS,EAAO/D,KACPmF,EAAaxF,EAAE,WAAY,CAC7B0C,MAAS,gBACT+C,KAAQpF,KAAKgC,QAAQX,iBACrBiB,MAAS,SAAS+C,GAChBA,EAAEC,eAAe,EACjBvB,EAAKwB,OAAO,CACd,CACF,CAAC,EACDvF,KAAKC,gBAAgBuF,MAAML,CAAU,CACvC,EACAM,WAAY,SAAU1F,EAAM2F,GAsC1B,MArCoB,UAAhB,OAAO3F,IACI,QAATA,IACE2F,EACF1F,KAAKuD,QAAQ,EAEbvD,KAAK2F,UAAU,GAGN,SAAT5F,KACE2F,EACF1F,KAAKwD,SAAS,EAEdxD,KAAK4F,WAAW,GAIF,UAAhB,OAAO7F,IACLA,EAAKmC,KACPlC,KAAK+B,KAAKhC,CAAI,GAEU,KAAA,IAAbA,EAAK2B,MACV3B,EAAK2B,IACP1B,KAAKuD,QAAQ,EAEbvD,KAAK2F,UAAU,GAGM,KAAA,IAAd5F,EAAK4B,OACV5B,EAAK4B,KACP3B,KAAKwD,SAAS,EAEdxD,KAAK4F,WAAW,KAMjB5F,IACT,EAEA6F,gBAAiB,SAAUR,GACzB,IAAIlD,EAASxC,EAAE0F,EAAES,cAAc,EAC/B,GAAInG,EAAE0F,EAAE7C,MAAM,EAAEC,QAAQ,OAAO,EAAEC,QAAW2C,EAAEU,SAA8B,EAAnBV,EAAEU,QAAQrD,OACjEP,EAAOD,KAAK,UAAW,CAAA,CAAK,MAD9B,CAIEC,EAAO6D,IAAI,SAAU,MAAM,EAAE9D,KAAK,UAAW,CAAA,CAAI,EAEnD,IAIM+D,EAJFC,EAAQ,EACRC,EAAQ,EACRC,EAASjE,EAAO6D,IAAI,WAAW,EAW/BK,GAVW,SAAXD,IACEH,EAAOG,EAAOE,MAAM,GAAG,EAGzBH,EAF2B,CAAC,IAA1BC,EAAOG,QAAQ,IAAI,GACrBL,EAAQM,SAASP,EAAK,EAAE,EAChBO,SAASP,EAAK,EAAE,IAExBC,EAAQM,SAASP,EAAK,GAAG,EACjBO,SAASP,EAAK,GAAG,IAGhB,GACTQ,EAAS,EACb,GAAKpB,EAAEqB,eAGA,GAA+B,IAA3BrB,EAAEqB,cAAchE,OACzB2D,EAAShB,EAAEqB,cAAc,GAAGC,MAAQT,EACpCO,EAASpB,EAAEqB,cAAc,GAAGE,MAAQT,OAC/B,GAA6B,EAAzBd,EAAEqB,cAAchE,OACzB,MACF,MAPE2D,EAAShB,EAAEsB,MAAQT,EACnBO,EAASpB,EAAEuB,MAAQT,EAOrBhE,EAAO0E,GAAG,sBAAsB,SAASxB,GACvC,GAAKlD,EAAOD,KAAK,SAAS,EAA1B,CAGA,IAAI4E,EAAO,EACPC,EAAO,EACX,GAAK1B,EAAEqB,eAGA,GAA+B,IAA3BrB,EAAEqB,cAAchE,OACzBoE,EAAOzB,EAAEqB,cAAc,GAAGC,MAAQN,EAClCU,EAAO1B,EAAEqB,cAAc,GAAGE,MAAQH,OAC7B,GAA6B,EAAzBpB,EAAEqB,cAAchE,OACzB,MACF,MAPEoE,EAAOzB,EAAEsB,MAAQN,EACjBU,EAAO1B,EAAEuB,MAAQH,EAOnB,IAQMO,EARFZ,EAASjE,EAAO6D,IAAI,WAAW,EACpB,SAAXI,EAC2B,CAAC,IAA1BA,EAAOG,QAAQ,IAAI,EACrBpE,EAAO6D,IAAI,YAAa,sBAAwBc,EAAO,KAAOC,EAAO,GAAG,EAExE5E,EAAO6D,IAAI,YAAa,gDAAkDc,EAAO,KAAOC,EAAO,SAAS,GAGtGC,EAASZ,EAAOE,MAAM,GAAG,EACA,CAAC,IAA1BF,EAAOG,QAAQ,IAAI,GACrBS,EAAO,GAAK,IAAMF,EAClBE,EAAO,GAAK,IAAMD,EAAO,MAEzBC,EAAO,IAAM,IAAMF,EACnBE,EAAO,IAAM,IAAMD,GAErB5E,EAAO6D,IAAI,YAAagB,EAAOC,KAAK,GAAG,CAAC,EA5B1C,CA8BF,CAAC,CA1DD,CA2DF,EAEAC,cAAe,SAAU7B,GACnBA,EAAEnD,KAAKiF,MAAMjF,KAAK,SAAS,GAC7BmD,EAAEnD,KAAKiF,MAAMjF,KAAK,UAAW,CAAA,CAAK,EAAE8D,IAAI,SAAU,SAAS,EAAEoB,IAAI,WAAW,CAEhF,EAEA7D,QAAS,WACPvD,KAAKC,gBAAgB+F,IAAI,WAAY,QAAQ,EAC7ChG,KAAKmC,OAAO0E,GAAG,uBAAwB7G,KAAK6F,eAAe,EAC3DlG,EAAEF,CAAQ,EAAEoH,GAAG,mBAAoB,CAAEM,MAASnH,KAAKmC,MAAO,EAAGnC,KAAKkH,aAAa,CACjF,EAEAvB,UAAW,WACT3F,KAAKC,gBAAgB+F,IAAI,WAAY,MAAM,EAC3ChG,KAAKmC,OAAOiF,IAAI,uBAAwBpH,KAAK6F,eAAe,EAC5DlG,EAAEF,CAAQ,EAAE2H,IAAI,mBAAoBpH,KAAKkH,aAAa,CACxD,EAEAG,iBAAkB,SAAUhC,GAC1B,IAAIiC,EAAKjC,EAAEnD,KAAKoF,GAEZC,GADJlC,EAAEC,eAAe,EACD,GAA8B,EAAzBD,EAAEmC,cAAcC,OAAa,CAAC,GAAM,KACzDH,EAAGI,cAAcJ,EAAGnF,OAAQoF,CAAQ,CACtC,EAEAI,iBAAkB,SAAUtC,GAC1B,IACMiC,EADHjC,EAAEU,SAAgC,IAArBV,EAAEU,QAAQrD,UACpB4E,EAAKjC,EAAEnD,KAAKoF,IACbnF,OAAOD,KAAK,WAAY,CAAA,CAAI,EAC3B0F,EAAON,EAAGO,aAAaxC,CAAC,EAC5BiC,EAAGnF,OAAOD,KAAK,iBAAkB0F,CAAI,EAEzC,EACAE,eAAgB,SAAUzC,GACxB,IAAIiC,EAAKjC,EAAEnD,KAAKoF,GACbA,EAAGnF,OAAOD,KAAK,UAAU,IACtB0F,EAAON,EAAGO,aAAaxC,CAAC,EAC5BiC,EAAGnF,OAAOD,KAAK,eAAgB0F,CAAI,EAEvC,EACAG,eAAgB,SAAU1C,GACxB,IAGM2C,EAHFV,EAAKjC,EAAEnD,KAAKoF,GACbA,EAAGnF,OAAOD,KAAK,UAAU,IAC1BoF,EAAGnF,OAAOD,KAAK,WAAY,CAAA,CAAK,EAErB,GADP8F,EAAOV,EAAGnF,OAAOD,KAAK,cAAc,EAAIoF,EAAGnF,OAAOD,KAAK,gBAAgB,GAEzEoF,EAAGI,cAAcJ,EAAGnF,OAAQ,GAAG,EACtB6F,EAAO,GAChBV,EAAGI,cAAcJ,EAAGnF,OAAQ,EAAG,EAGrC,EAEAqB,SAAU,WACRxD,KAAKC,gBAAgB4G,GAAG,QAAS,CAAES,GAAMtH,IAAK,EAAGA,KAAKqH,gBAAgB,EACtErH,KAAKC,gBAAgB4G,GAAG,aAAc,CAAES,GAAMtH,IAAK,EAAGA,KAAK2H,gBAAgB,EAC3EhI,EAAEF,CAAQ,EAAEoH,GAAG,YAAa,CAAES,GAAMtH,IAAK,EAAGA,KAAK8H,cAAc,EAC/DnI,EAAEF,CAAQ,EAAEoH,GAAG,WAAY,CAAES,GAAMtH,IAAK,EAAGA,KAAK+H,cAAc,CAChE,EACAnC,WAAY,WACV5F,KAAKC,gBAAgBmH,IAAI,QAASpH,KAAKqH,gBAAgB,EACvDrH,KAAKC,gBAAgBmH,IAAI,aAAcpH,KAAK2H,gBAAgB,EAC5DhI,EAAEF,CAAQ,EAAE2H,IAAI,YAAapH,KAAK8H,cAAc,EAChDnI,EAAEF,CAAQ,EAAE2H,IAAI,WAAYpH,KAAK+H,cAAc,CACjD,EAEAF,aAAc,SAAUxC,GACtB,OAAO4C,KAAKC,MAAM7C,EAAEU,QAAQ,GAAGoC,QAAU9C,EAAEU,QAAQ,GAAGoC,UAAY9C,EAAEU,QAAQ,GAAGoC,QAAU9C,EAAEU,QAAQ,GAAGoC,UACrG9C,EAAEU,QAAQ,GAAGqC,QAAU/C,EAAEU,QAAQ,GAAGqC,UAAY/C,EAAEU,QAAQ,GAAGqC,QAAU/C,EAAEU,QAAQ,GAAGqC,QAAQ,CAC/F,EAEAV,cAAe,SAAUvF,EAAQoF,GAC/B,IAEIP,EAFAjH,EAAOoC,EAAOD,KAAK,SAAS,EAC5BkE,EAASjE,EAAO6D,IAAI,WAAW,EAE/BqC,EAAc,EACH,SAAXjC,EACFjE,EAAO6D,IAAI,YAAa,SAAWuB,EAAW,IAAMA,EAAW,GAAG,GAElEP,EAASZ,EAAOE,MAAM,GAAG,EACI,CAAC,IAA1BF,EAAOG,QAAQ,IAAI,GACrB8B,EAAcJ,KAAKK,IAAI9I,EAAO+I,WAAWvB,EAAO,EAAE,EAAIO,CAAQ,GAC5CxH,EAAK8B,cAAgBwG,EAActI,EAAK6B,aACxDO,EAAO6D,IAAI,YAAaI,EAAS,UAAYmB,EAAW,IAAMA,EAAW,GAAG,GAG9Ec,EAAcJ,KAAKK,IAAI9I,EAAO+I,WAAWvB,EAAO,EAAE,EAAIO,CAAQ,GAC5CxH,EAAK8B,cAAgBwG,EAActI,EAAK6B,aACxDO,EAAO6D,IAAI,YAAaI,EAAS,YAAcmB,EAAW,IAAMA,EAAW,MAAM,EAIzF,EAEArE,YAAa,SAAUsF,GACrB,IAAIzE,EAAO/D,KACPyI,EAAS,CACXC,KAAQF,EAAIG,SAAS,EAAEC,GAAG,CAAC,EAAExD,KAAK,EAAEyD,KAAK,EACzCzF,cAAiBoF,EAAIM,OAAO,EAAEA,OAAO,EAAEC,GAAG,IAAI,EAAI,IAAK,MAAQP,EAAIQ,SAAS,IAAI,EAAEtG,OAAS,EAAG,IAAM8F,EAAIrF,SAAS,IAAI,EAAET,OAAS,EAAI,EACtI,EAQA,OAPA/C,EAAE+D,KAAK8E,EAAItG,KAAK,EAAG,SAAS+G,EAAKC,GAC9BT,EAAOQ,GAAOC,CACjB,CAAC,EACDV,EAAIrF,SAAS,IAAI,EAAEA,SAAS,EAAEO,KAAK,WAC5B+E,EAAOtF,WAAYsF,EAAOtF,SAAW,IAC1CsF,EAAOtF,SAASgG,KAAKpF,EAAKb,YAAYvD,EAAEK,IAAI,CAAC,CAAC,CAChD,CAAC,EACMyI,CACT,EAEApF,UAAW,SAAUnB,EAAMkH,GACzB,IAAIrF,EAAO/D,KAiBX,OAhBAkC,EAAKkB,aAAegG,GAASlH,EAAKiB,UAAmC,EAAvBjB,EAAKiB,SAAST,OAAa,EAAI,GACzE1C,KAAKgC,SAASqH,SAASC,cAAgBC,UAAYvJ,KAAKgC,QAAQqH,QAAQnH,CAAI,IAC9EA,EAAKmH,QAAU,CAAA,GAEbnH,EAAKiB,UACPjB,EAAKiB,SAASqG,QAAQ,SAASC,GACzBvH,EAAKwH,QAAUxH,EAAKyH,SACtBF,EAAKE,SAAW,CAAA,EACPzH,EAAKmH,SAAWI,EAAKtG,SAC9BsG,EAAKJ,QAAU,CAAA,EACNnH,EAAKmH,SAAW,CAACI,EAAKtG,WAC/BsG,EAAKG,kBAAoB,CAAA,GAE3B7F,EAAKV,UAAUoG,EAAM,KAA8B,EAAvBvH,EAAKiB,SAAST,OAAa,EAAI,EAAE,CAC/D,CAAC,EAEIR,CACT,EAEA2H,UAAW,SAAU1H,EAAQ2H,GAC3BA,EAAuC,OAApBA,GAA4BA,IAAoBlK,GAAakK,EAChF,IAAI/F,EAAO/D,KACP+J,EAAQ5H,EAAOQ,KAAK,aAAa,EACjC8F,EAAS,CAAEuB,GAAMD,EAAM,GAAGC,EAAG,EAUjC,OATIF,GACFnK,EAAE+D,KAAKqG,EAAM7H,KAAK,UAAU,EAAG,SAAU+G,EAAKC,GAC5CT,EAAOQ,GAAOC,CAChB,CAAC,EAEHa,EAAMf,SAAS,QAAQ,EAAE7F,SAAS,EAAEO,KAAK,WAClC+E,EAAOtF,WAAYsF,EAAOtF,SAAW,IAC1CsF,EAAOtF,SAASgG,KAAKpF,EAAK8F,UAAUlK,EAAEK,IAAI,EAAG8J,CAAe,CAAC,CAC/D,CAAC,EACMrB,CACT,EAEAwB,aAAc,SAAUH,GAEtB,IAMQI,EANR,OADAJ,EAAuC,OAApBA,GAA4BA,IAAoBlK,GAAakK,EACrD,KAAA,IAAhB9J,KAAKmC,OACP,iCAEFnC,KAAKmC,OAAOQ,KAAK,OAAO,EAAED,QAGzBwH,EAAQ,CAAA,EACZlK,KAAKmC,OAAOQ,KAAK,OAAO,EAAEe,KAAK,WAC7B,GAAI,CAAC1D,KAAKgK,GAER,OADAE,EAAQ,CAAA,CAGZ,CAAC,EACIA,EAKFlK,KAAK6J,UAAU7J,KAAKmC,OAAQ2H,CAAe,EAJrC,4EAVF,2BAeb,EAEAK,aAAc,SAAUJ,EAAOK,GAC7B,IAAIpF,EAAU,GACVqF,EAAiB,CAAC,CAACN,EAAMtH,QAAQ,UAAU,EAAEC,OAEjD,GAAiB,YAAb0H,EADWA,GAAY,SAazB,GAXIC,GACFrF,EAAU+E,EAAMtH,QAAQ,IAAI,EAAEqB,QAAQ,IAAI,GAC7BpB,SACXsC,EAAU+E,EAAMtH,QAAQ,QAAQ,GACnBC,SACXsC,EAAU+E,EAAMtH,QAAQ,WAAW,EAAEuG,SAAS,QAAQ,GAI1DhE,EAAU+E,EAAMtH,QAAQ,QAAQ,EAAEuG,SAAS,OAAO,EAEhDhE,EAAQtC,OACV,OAAIsC,EAAQ+D,GAAG,SAAS,GAAM,CAAC/D,EAAQ+D,GAAG,SAAS,GAAK/D,EAAQvC,QAAQ,QAAQ,EAAEsG,GAAG,SAAS,GAAO,CAAC/D,EAAQ+D,GAAG,SAAS,GAAK/D,EAAQvC,QAAQ,WAAW,EAAEsG,GAAG,SAAS,EAC/J,CAAEuB,MAAS,CAAA,EAAMC,QAAW,CAAA,CAAM,EAEpC,CAAED,MAAS,CAAA,EAAMC,QAAW,CAAA,CAAK,CAC1C,MACK,GAAiB,aAAbH,GAET,IADApF,EAAUqF,EAAiBN,EAAMjB,OAAO,EAAE3F,SAAS,IAAI,EAAI4G,EAAMf,SAAS,QAAQ,GACtEtG,OACV,OAAKsC,EAAQ+D,GAAG,SAAS,EAGlB,CAAEuB,MAAS,CAAA,EAAMC,QAAW,CAAA,CAAM,EAFhC,CAAED,MAAS,CAAA,EAAMC,QAAW,CAAA,CAAK,CAG5C,MACK,GAAiB,aAAbH,GAET,IADApF,EAAUqF,EAAiBN,EAAMtH,QAAQ,IAAI,EAAIsH,EAAMjB,OAAO,EAAEE,SAAS,GAC7DtG,SAAW,CAAC2H,GAAkD,EAAhCrF,EAAQ7B,SAAS,IAAI,EAAET,QAC/D,OAAKsC,EAAQ+D,GAAG,SAAS,GAAM/D,EAAQ8D,OAAO,EAAEC,GAAG,SAAS,GAAOsB,GAAmBrF,EAAQvC,QAAQ,WAAW,EAAEsG,GAAG,SAAS,EAGxH,CAAEuB,MAAS,CAAA,EAAMC,QAAW,CAAA,CAAM,EAFhC,CAAED,MAAS,CAAA,EAAMC,QAAW,CAAA,CAAK,CAG5C,MAGA,IADAvF,EAAU+E,GACErH,OACV,OAAOsC,EAAQvC,QAAQ,QAAQ,EAAEC,QAAUsC,EAAQvC,QAAQ,QAAQ,EAAEsG,GAAG,SAAS,GAC9E/D,EAAQvC,QAAQ,YAAY,EAAEC,QAAUsC,EAAQvC,QAAQ,YAAY,EAAEsG,GAAG,SAAS,GAClF/D,EAAQvC,QAAQ,WAAW,EAAEC,SAAWsC,EAAQvC,QAAQ,QAAQ,EAAEsG,GAAG,SAAS,GAAK/D,EAAQvC,QAAQ,WAAW,EAAEsG,GAAG,SAAS,GAIxH,CAAEuB,MAAS,CAAA,EAAMC,QAAW,CAAA,CAAM,EAFhC,CAAED,MAAS,CAAA,EAAMC,QAAW,CAAA,CAAK,EAK9C,MAAO,CAAED,MAAS,CAAA,EAAOC,QAAW,CAAA,CAAM,CAC5C,EACAC,UAAW,SAAUT,GACnB,OAAO/J,KAAKyK,gBAAgBV,EAAO,QAAQ,CAC7C,EACAW,YAAa,SAAUX,GACrB,OAAO/J,KAAKyK,gBAAgBV,EAAO,UAAU,CAC/C,EACAY,YAAa,SAAUZ,GACrB,OAAO/J,KAAKyK,gBAAgBV,EAAO,UAAU,CAC/C,EAEAU,gBAAiB,SAAUV,EAAOK,GAChC,OAAKL,GAAWA,aAAiBpK,GAAOoK,EAAMhB,GAAG,OAAO,EAGvC,WAAbqB,EACKL,EAAMtH,QAAQ,QAAQ,EAAEuG,SAAS,OAAO,EACzB,aAAboB,EACFL,EAAMf,SAAS,QAAQ,EAAE7F,SAAS,YAAY,EAAER,KAAK,aAAa,EACnD,aAAbyH,EACFL,EAAMtH,QAAQ,YAAY,EAAEuG,SAAS,EAAErG,KAAK,aAAa,EAEzDhD,EAAE,EATFA,EAAE,CAWb,EACAiL,cAAe,SAAUrI,GACvB5C,EAAE4C,EAAMC,MAAM,EAAEI,YAAY,SAAS,EACrCL,EAAML,KAAK4G,OAAOjF,SAAS,QAAQ,CACrC,EAEAgH,WAAY,SAAUd,GACpB,IAAIe,EAAUf,EAAMtH,QAAQ,QAAQ,EAAEuG,SAAS,OAAO,EAClD8B,EAAQnI,KAAK,UAAU,EAAED,QAC3BqH,EAAMtH,QAAQ,WAAW,EAAEP,KAAK,SAAU,CAAA,CAAK,EAG7ClC,KAAKmK,aAAaJ,EAAO,UAAU,EAAEQ,SACvCvK,KAAK+K,aAAahB,CAAK,EAGzBA,EAAMjB,OAAO,EAAEjF,SAAS,sBAAsB,EAE1C7D,KAAKmK,aAAaW,CAAO,EAAEP,SAC7BO,EAAQjH,SAAS,oBAAoB,EAAEmH,IAAI,gBAAiB,CAAElC,OAAUgC,CAAQ,EAAG9K,KAAK4K,aAAa,EAGnG5K,KAAKmK,aAAaW,EAAS,QAAQ,EAAEP,SACvCvK,KAAK6K,WAAWC,CAAO,CAE3B,EACAG,cAAe,SAAU1I,GACvB,IAAIwH,EAAQxH,EAAML,KAAK0B,KACvBjE,EAAE4C,EAAMC,MAAM,EAAEI,YAAY,SAAS,EACjC5C,KAAKkL,WAAWnB,CAAK,GACvB/J,KAAKmL,oBAAoBpB,EAAM5G,SAAS,UAAU,CAAC,CAEvD,EAEAiI,WAAY,SAAUrB,GAEpB,IAAIe,EAAUf,EAAMtH,QAAQ,QAAQ,EAAEuG,SAAS,OAAO,EAAEpG,YAAY,QAAQ,EAE5EmH,EAAMtH,QAAQ,YAAY,EAAEG,YAAY,sBAAsB,EAE9D5C,KAAKqL,QAAQP,EAAQ,EAAE,EACvBA,EAAQjH,SAAS,SAAS,EAAEjB,YAAY,YAAY,EAAEoI,IAAI,gBAAiB,CAAEpH,KAAQmG,CAAM,EAAG/J,KAAKiL,cAAcK,KAAKtL,IAAI,CAAC,CAC7H,EACAuL,SAAU,SAAUC,GACdA,EAAW7I,KAAK,UAAU,EAAED,QAC9B8I,EAAW/I,QAAQ,WAAW,EAAEP,KAAK,SAAU,CAAA,CAAK,CAExD,EACAuJ,cAAe,SAAU9H,EAAO7D,GAC9B,OAAOE,KAAKmK,aAAaxK,EAAEG,CAAI,CAAC,EAAEyK,OACpC,EACAmB,oBAAqB,SAAU/H,EAAO7D,GACpC,OAAOH,EAAEG,CAAI,EAAEgJ,OAAO,EAAEC,GAAG,eAAe,CAC5C,EAEA4C,gBAAiB,SAAUpJ,GACzB,IAAIwH,EAAQxH,EAAML,KAAK0B,KACvBrB,EAAML,KAAK0J,cAAchJ,YAAY,SAAS,EAC9CL,EAAML,KAAK0J,cAAcnJ,QAAQ,QAAQ,EAAEoB,SAAS,QAAQ,EACxD7D,KAAKkL,WAAWnB,CAAK,GACvB/J,KAAKmL,oBAAoBpB,EAAM5G,SAAS,aAAa,CAAC,CAE1D,EAEA0I,aAAc,SAAU9B,GACtBA,EAAMtH,QAAQ,YAAY,EAAEoB,SAAS,qBAAqB,EAC1D,IAAIiI,EAAc/B,EAAMf,SAAS,QAAQ,EAErC+C,GADJ/L,KAAKuL,SAASO,CAAW,EACJA,EAAYnJ,KAAK,OAAO,EAAEqJ,OAAOhM,KAAKyL,cAAcH,KAAKtL,IAAI,CAAC,EAAEiM,IAAIjM,KAAK0L,oBAAoBJ,KAAKtL,IAAI,CAAC,GACvG8L,EAAY/C,GAAG,WAAW,GAE7CgD,EAAetJ,QAAQ,YAAY,EAAEoB,SAAS,uBAAuB,GAEnEiI,EAAY/C,GAAG,WAAW,GAAK+C,EAAYnJ,KAAK,WAAW,EAAED,SAC/DqJ,EAAepJ,KAAK3C,KAAKgC,QAAQ7B,MAAMU,QAAQ,EAAE+B,YAAY5C,KAAKgC,QAAQ7B,MAAMU,QAAQ,EAAEgD,SAAS7D,KAAKgC,QAAQ7B,MAAMS,SAAS,EAEjIZ,KAAKqL,QAAQU,EAAeG,IAAI,CAAC,CAAC,EAClCH,EAAelI,SAAS,kBAAkB,EAAE+E,GAAG,CAAC,EAAEoC,IAAI,gBAAiB,CAAEY,cAAiBG,EAAgBI,WAAcL,EAAalI,KAAQmG,CAAM,EAAG/J,KAAK2L,gBAAgBL,KAAKtL,IAAI,CAAC,CACvL,EAEAoM,gBAAiB,SAAU7J,GACzB,IAAIwH,EAAQxH,EAAML,KAAK0B,KACvBrB,EAAML,KAAK0J,cAAchJ,YAAY,SAAS,EAC1C5C,KAAKkL,WAAWnB,CAAK,GACvB/J,KAAKmL,oBAAoBpB,EAAM5G,SAAS,aAAa,CAAC,CAE1D,EAEAkJ,aAAc,SAAUtC,GAEtBA,EAAMtH,QAAQ,YAAY,EAAEG,YAAY,qBAAqB,EAD7D,IAEI0J,EAAUvC,EAAMf,SAAS,QAAQ,EACjCuD,EAAiBD,EAAQvD,GAAG,WAAW,EACvCgD,GAAiBQ,EACjBD,EAAQ1J,YAAY,QAAQ,EAAED,KAAK,OAAO,EAC1C2J,EAAQ1J,YAAY,QAAQ,EAAEO,SAAS,YAAY,EAAER,KAAK,aAAa,GAD3BqJ,OAAOhM,KAAKyL,cAAcH,KAAKtL,IAAI,CAAC,EAE/EuM,IACHR,EAAeC,OAAO,mBAAmB,EAAEvJ,QAAQ,YAAY,EAAEoB,SAAS,qBAAqB,EAC/FkI,EAAetJ,QAAQ,YAAY,EAAEG,YAAY,uBAAuB,GAG1E5C,KAAKqL,QAAQU,EAAeG,IAAI,CAAC,CAAC,EAClCH,EAAelI,SAAS,SAAS,EAAEjB,YAAY,UAAU,EAAEgG,GAAG,CAAC,EAAEoC,IAAI,gBAAiB,CAAEpH,KAAQmG,EAAO6B,cAAiBG,CAAe,EAAG/L,KAAKoM,gBAAgBd,KAAKtL,IAAI,CAAC,CAC3K,EAEAwM,gBAAiB,SAAUjK,GACzB,IAAIwB,EAAO/D,KACP+J,EAAQxH,EAAML,KAAK0B,KACnB6I,EAAiBlK,EAAML,KAAKwK,cAC5BjL,EAAYc,EAAML,KAAKT,UACvBkL,EAAYlL,EAA2B,SAAdA,EAAuBgL,EAAeG,QAAQ,eAAe,EAAIH,EAAeI,QAAQ,eAAe,EAAKJ,EAAezD,SAAS,EACjKzG,EAAML,KAAK0J,cAAchJ,YAAY,SAAS,EAC9C+J,EAAUhK,KAAK,aAAa,EAAEqJ,OAAOhM,KAAKyL,cAAcH,KAAKtL,IAAI,CAAC,EAC/D4C,YAAY,wBAAwB,EACpCiB,SAAS,WACR,OAAIE,EAAK/B,QAAQqH,QACR,GAEA,UAEX,CAAC,EACHsD,EAAUhK,KAAK,mBAAmB,EAAEkB,SAAS,QAAQ,EAClDiJ,IAAI,EAAEjJ,SAAS,QAAQ,EAEtB7D,KAAKkL,WAAWnB,CAAK,GACvB/J,KAAK+M,sBAAsBhD,CAAK,CAEpC,EAEAgB,aAAc,SAAUhB,EAAOtI,GAC7B,IACIgL,EAAiB1C,EAAMtH,QAAQ,YAAY,EAAEoB,SAAS,qBAAqB,EAqB3EkI,GApBAU,EAAezD,SAAS,EAAErG,KAAK,UAAU,EAAED,QAC7CqH,EAAMtH,QAAQ,WAAW,EAAEP,KAAK,SAAU,CAAA,CAAK,EAE7CT,EACgB,SAAdA,EACFgL,EAAe5I,SAAS,WAAW,EAChC+I,QAAQ,sBAAsB,EAAEhK,YAAY,+BAA+B,EAAEkK,IAAI,EACjFF,QAAQ,EAAE/I,SAAS,wCAAwC,EAC3DlB,KAAK,OAAO,EAAEqJ,OAAOhM,KAAKyL,cAAcH,KAAKtL,IAAI,CAAC,EAAE6D,SAAS,qBAAqB,EAErF4I,EAAe5I,SAAS,YAAY,EACjCgJ,QAAQ,sBAAsB,EAAEjK,YAAY,gCAAgC,EAAEkK,IAAI,EAClFD,QAAQ,EAAEhJ,SAAS,wCAAwC,EAC3DlB,KAAK,OAAO,EAAEqJ,OAAOhM,KAAKyL,cAAcH,KAAKtL,IAAI,CAAC,EAAE6D,SAAS,oBAAoB,GAGtF4I,EAAeG,QAAQ,EAAEjK,KAAK,OAAO,EAAEqJ,OAAOhM,KAAKyL,cAAcH,KAAKtL,IAAI,CAAC,EAAE6D,SAAS,qBAAqB,EAC3G4I,EAAeI,QAAQ,EAAElK,KAAK,OAAO,EAAEqJ,OAAOhM,KAAKyL,cAAcH,KAAKtL,IAAI,CAAC,EAAE6D,SAAS,oBAAoB,EAC1G4I,EAAezD,SAAS,EAAEnF,SAAS,wCAAwC,GAExD4I,EAAezD,SAAS,EAAErG,KAAK,UAAU,GAC9DoJ,EAAenD,GAAG,CAAC,EAAEoC,IAAI,gBAAiB,CAAEpH,KAAQmG,EAAO2C,cAAiBD,EAAgBhL,UAAaA,EAAWmK,cAAiBG,CAAe,EAAG/L,KAAKwM,gBAAgBlB,KAAKtL,IAAI,CAAC,CACxL,EAEAgN,gBAAiB,SAAUzK,GACzB,IAAIwH,EAAQxH,EAAML,KAAK0B,KACvBrB,EAAML,KAAK+K,aAAarK,YAAY,SAAS,EACzC5C,KAAKkL,WAAWnB,CAAK,IACvB/J,KAAK+M,sBAAsBhD,CAAK,EAChCA,EAAM5G,SAAS,UAAU,EAAEP,YAAY5C,KAAKgC,QAAQ7B,MAAMG,UAAU,EAAEuD,SAAS7D,KAAKgC,QAAQ7B,MAAMI,cAAc,EAEpH,EAEA2M,qBAAsB,SAAS3K,GAC7B5C,EAAE4C,EAAMC,MAAM,EAAEI,YAAY,SAAS,CACvC,EAEAuK,aAAc,SAAUpD,EAAOtI,GAC7B,IAEIkL,EAAYhN,EAAE,EACd8M,EAAiB1C,EAAMtH,QAAQ,YAAY,EAG3CkK,GAFAlL,EACgB,SAAdA,EACUgL,EAAeG,QAAQ,EAEvBH,EAAeI,QAAQ,EAGzB9C,EAAMtH,QAAQ,YAAY,EAAEuG,SAAS,GALVpG,YAAY,QAAQ,EAQzDwK,EAAcrD,EAAMtH,QAAQ,QAAQ,EAAEuG,SAAS,OAAO,EAmBtDqE,GAlBA5L,GACFgL,EAAe7J,YAAYnB,EAAY,OAAO,EACzCgL,EAAe1D,GAAG,gBAAgB,GACrC0D,EAAe7J,YAAY,qBAAqB,EAElD+J,EAAU/J,YAAY,sBAAwBnB,EAAY,OAAO,IAEjEsI,EAAMtH,QAAQ,YAAY,EAAEG,YAAY,qBAAqB,EAC7D+J,EAAU/J,YAAY,oBAAoB,GAGvC5C,KAAKmK,aAAaJ,EAAO,QAAQ,EAAEQ,UACtCR,EAAMtH,QAAQ,YAAY,EAAEG,YAAY,sBAAsB,EAC9DwK,EAAYxK,YAAY,QAAQ,EAChC5C,KAAKqL,QAAQ+B,EAAY,EAAE,EAC3BA,EAAYvJ,SAAS,SAAS,EAAEjB,YAAY,YAAY,EAAEoI,IAAI,gBAAiBhL,KAAKkN,oBAAoB,GAGtFP,EAAUhK,KAAK,OAAO,EAAEqJ,OAAOhM,KAAKyL,cAAcH,KAAKtL,IAAI,CAAC,GAChFA,KAAKqL,QAAQgC,EAAcnB,IAAI,CAAC,CAAC,EACjCmB,EAAcxJ,SAAS,SAAS,EAAEjB,YAAY,wBAAwB,EACtEyK,EAAczE,GAAG,CAAC,EAAEoC,IAAI,gBAAiB,CAAEpH,KAAQmG,EAAOkD,aAAgBI,CAAc,EAAGrN,KAAKgN,gBAAgB1B,KAAKtL,IAAI,CAAC,CAC5H,EAEAsN,aAAc,SAAUC,GACtB,IAAIpL,EAASnC,KAAKmC,OAClB,OAAqC,KAAA,IAA1BA,EAAOD,KAAK,QAAQ,GAA+C,CAAA,IAA1BC,EAAOD,KAAK,QAAQ,KAIxEqL,EAAM1J,SAAS,QAAQ,EACvB0J,EAAMzE,OAAO,EAAE9F,oBAAoBhD,KAAKgC,QAAQ7B,MAAMC,SAASJ,KAAKgC,QAAQ7B,MAAMW,uBAAuB,EACtGqC,SAAS,EAAE8I,IAAI,UAAU,EAAEjG,IAAI,UAAW,EAAG,EAChD7D,EAAOD,KAAK,SAAU,CAAA,CAAI,EAC1BvC,EAAE,gBAAgB,EAAE6N,KAAK,WAAY,CAAA,CAAI,EAClC,CAAA,EACT,EAEAC,WAAY,SAAUF,GACpB,IAAIxD,EAAQwD,EAAMzE,OAAO,EACzByE,EAAM3K,YAAY,QAAQ,EAC1BmH,EAAMpH,KAAK,UAAU,EAAEP,OAAO,EAC9B2H,EAAM5G,SAAS,EAAEuK,WAAW,OAAO,EACnC1N,KAAKmC,OAAOD,KAAK,SAAU,CAAA,CAAK,EAChCvC,EAAE,gBAAgB,EAAE6N,KAAK,WAAY,CAAA,CAAK,CAC5C,EAEAtC,WAAY,SAAUnB,GACpB,MAAO,CACL/J,KAAKgC,QAAQ7B,MAAMG,WACnBN,KAAKgC,QAAQ7B,MAAMI,eACnBP,KAAKgC,QAAQ7B,MAAMK,eACnBR,KAAKgC,QAAQ7B,MAAMM,eACnBkN,KAAK,GAAgE,CAAC,EAAvD5D,EAAM5G,SAAS,OAAO,EAAEyK,KAAK,OAAO,EAAErH,QAAQsH,CAAI,CAAM,CAC3E,EAEA1C,oBAAqB,SAAU2C,GAC7BA,EAAOC,YAAe/N,KAAKgC,QAAQ7B,MAAMG,WAAtB,IAAoCN,KAAKgC,QAAQ7B,MAAMI,cAAgB,CAC5F,EAEAwM,sBAAuB,SAAUhD,GAC/B,IAoBMiE,EApBFjO,EAAOC,KAAKgC,QACZjC,EAAKkB,qBAA+C,KAAA,IAAjBlB,EAAKkO,SAA2BlE,EAAMtH,QAAQ,QAAQ,EAAEP,KAAK,gBAAgB,KAC9GgM,EAAWnE,EAAMjB,OAAO,EAAEqF,KAAK,GACtBzL,SACPwL,EAASnF,GAAG,SAAS,EACvBgB,EAAM5G,SAAS,WAAW,EAAEU,SAAS9D,EAAKI,MAAMK,cAAc,EAAEoC,YAAY7C,EAAKI,MAAMM,aAAa,EAEpGsJ,EAAM5G,SAAS,WAAW,EAAEU,SAAS9D,EAAKI,MAAMM,aAAa,EAAEmC,YAAY7C,EAAKI,MAAMK,cAAc,IAGpG4N,EAAWrE,EAAMjB,OAAO,EAAEuF,KAAK,GACtB3L,SACP0L,EAASrF,GAAG,SAAS,EACvBgB,EAAM5G,SAAS,YAAY,EAAEU,SAAS9D,EAAKI,MAAMM,aAAa,EAAEmC,YAAY7C,EAAKI,MAAMK,cAAc,EAErGuJ,EAAM5G,SAAS,YAAY,EAAEU,SAAS9D,EAAKI,MAAMK,cAAc,EAAEoC,YAAY7C,EAAKI,MAAMM,aAAa,KAKrGuN,EAAcM,CAAAA,EADdA,EAAQvE,EAAMjB,OAAO,EAAEE,SAAS,GACZtG,QAAS,CAAC4L,EAAMvF,GAAG,SAAS,EACpDgB,EAAM5G,SAAS,WAAW,EAAE4K,YAAYhO,EAAKI,MAAMM,cAAeuN,CAAW,EAAED,YAAYhO,EAAKI,MAAMK,eAAgB,CAACwN,CAAW,EAClIjE,EAAM5G,SAAS,YAAY,EAAE4K,YAAYhO,EAAKI,MAAMK,eAAgBwN,CAAW,EAAED,YAAYhO,EAAKI,MAAMM,cAAe,CAACuN,CAAW,EAEvI,EAEA3C,QAAS,SAAUzH,GACbA,IACFA,EAAK2K,MAAMC,YAAc5K,EAAK4K,YAElC,EAEAC,sBAAuB,SAAUlM,GAC/B,IAaMmM,EAEAC,EACAC,EAhBF7E,EAAQpK,EAAE4C,EAAMuD,cAAc,EAC9B+I,EAAO,CAAA,EACP9E,EAAMtH,QAAQ,iBAAiB,EAAEC,QAC/BoM,EAAa/E,EAAM5G,SAAS,YAAY,EACzB,eAAfZ,EAAMwM,KACJhF,EAAM5G,SAAS,YAAY,EAAET,SAC/BmM,EAAO7O,KAAKmK,aAAaJ,EAAO,UAAU,EAAEQ,QAC5CuE,EAAWf,YAAY/N,KAAKgC,QAAQ7B,MAAMS,UAAW,CAACiO,CAAI,EAAEd,YAAY/N,KAAKgC,QAAQ7B,MAAMU,SAAUgO,CAAI,GAG3GC,EAAWlM,YAAe5C,KAAKgC,QAAQ7B,MAAMS,UAAtB,IAAmCZ,KAAKgC,QAAQ7B,MAAMU,QAAU,IAGrF6N,EAAW3E,EAAM5G,SAAS,UAAU,EACvB4G,EAAM5G,SAAS,YAAY,EACxCwL,EAAc5E,EAAM5G,SAAS,aAAa,EAC1CyL,EAAY7E,EAAM5G,SAAS,WAAW,EACvB,eAAfZ,EAAMwM,MACJL,EAAShM,SACXmM,EAAO7O,KAAKmK,aAAaJ,EAAO,QAAQ,EAAEQ,QAC1CmE,EAASX,YAAY/N,KAAKgC,QAAQ7B,MAAMG,WAAY,CAACuO,CAAI,EAAEd,YAAY/N,KAAKgC,QAAQ7B,MAAMI,eAAgBsO,CAAI,GAE5GF,EAAYjM,SACdmM,EAAO7O,KAAKmK,aAAaJ,EAAO,UAAU,EAAEQ,QAC5CoE,EAAYZ,YAAY/N,KAAKgC,QAAQ7B,MAAMI,eAAgB,CAACsO,CAAI,EAAEd,YAAY/N,KAAKgC,QAAQ7B,MAAMG,WAAYuO,CAAI,GAE/GD,EAAUlM,QACZ1C,KAAK+M,sBAAsBhD,CAAK,GAGlCA,EAAM5G,SAAS,OAAO,EAAEP,eAAe5C,KAAKgC,QAAQ7B,MAAMG,cAAcN,KAAKgC,QAAQ7B,MAAMI,kBAAkBP,KAAKgC,QAAQ7B,MAAMK,kBAAkBR,KAAKgC,QAAQ7B,MAAMM,aAAe,EAG1L,EAEAuO,iBAAkB,SAAUzM,GAC1BvC,KAAKmC,OAAOQ,KAAK,UAAU,EAAEC,YAAY,SAAS,EAClDjD,EAAE4C,EAAMuD,cAAc,EAAEjC,SAAS,SAAS,CAC5C,EACAoL,aAAc,SAAU/M,EAAMgN,GAC5B,IAAIrM,EAAQ7C,KAAKmC,OAAOgB,SAAS,QAAQ,EAAEA,SAAS,YAAY,EAChEnD,KAAKiD,eAAeJ,EAAOX,CAAI,EAC/BW,EAAMM,SAAS,EAAEgM,MAAM,EAAG,CAAC,EACxBC,QAAQ,6BAA6B,EAAEtG,OAAO,EAC9CuG,SAAS1P,EAAE,IAAMuP,CAAQ,EAAElG,SAAS,QAAQ,CAAC,CAClD,EACAsG,eAAe,SAAUpN,EAAM4I,GAC7B,IAAI/G,EAAO/D,KACPuP,EAAe5P,EAAE,yBAAyB,EAC9CmL,EAAQtF,MAAM+J,CAAY,EAC1B5P,EAAE+D,KAAKxB,EAAM,SAAUkC,GACrBmL,EAAavM,OAAOrD,EAAE,6BAA6B,CAAC,EACpDoE,EAAKd,eAAesM,EAAapM,SAAS,EAAEyF,GAAGxE,CAAC,EAAGpE,IAAI,CACzD,CAAC,CACH,EAEAwP,mBAAoB,SAAUjN,GAC5B,IAAImM,EAAWnM,EAAML,KAAKuN,QACtB1F,EAAQ2E,EAAS5F,OAAO,EACxB9I,KAAKkL,WAAWnB,CAAK,IACvB/J,KAAKmL,oBAAoBuD,CAAQ,EACjC1O,KAAK+M,sBAAsBhD,CAAK,EAEpC,EAEA2F,oBAAqB,SAAUnN,GAC7B,IAKMuI,EAJF4D,EAAW/O,EAAE4C,EAAMC,MAAM,EACzBuH,EAAQpK,EAAE4C,EAAMuD,cAAc,EAC9B6J,EAAc3P,KAAKmK,aAAaJ,EAAO,QAAQ,EAC/C4F,EAAYrF,OAEVQ,EADAA,EAAUf,EAAMtH,QAAQ,QAAQ,EAAEuG,SAAS,OAAO,GAC1CD,GAAG,UAAU,IAErB4G,EAAYpF,SACdvK,KAAK6K,WAAWd,CAAK,EACrBe,EAAQE,IAAI,gBAAiB,CAAEyE,QAAWf,CAAS,EAAG1O,KAAKwP,mBAAmBlE,KAAKtL,IAAI,CAAC,EACxFA,KAAKkF,iBAAiB6E,EAAO,QAAQ,IAErC/J,KAAKoL,WAAWrB,CAAK,EACrB/J,KAAK+E,iBAAiBgF,EAAO,QAAQ,GAG3C,EAEA6F,uBAAwB,SAAUrN,GACd5C,EAAE4C,EAAMC,MAAM,EAAhC,IACIuH,EAAQpK,EAAE4C,EAAMuD,cAAc,EAC9B+J,EAAgB7P,KAAKmK,aAAaJ,EAAO,UAAU,EACnD8F,EAAcvF,OAEZwF,CADY/F,EAAMf,SAAS,QAAQ,EAAE7F,SAAS,EAAEA,SAAS,OAAO,EACtD4F,GAAG,UAAU,IAEvB8G,EAActF,SAChBvK,KAAK6L,aAAa9B,CAAK,EACvB/J,KAAKkF,iBAAiB6E,EAAO,UAAU,IAEvC/J,KAAKqM,aAAatC,CAAK,EACvB/J,KAAK+E,iBAAiBgF,EAAO,UAAU,GAG7C,EAEAgG,kBAAmB,SAAUxN,GAC3B,IASQ6L,EATJ4B,EAASrQ,EAAE4C,EAAMC,MAAM,EACvBuH,EAAQpK,EAAE4C,EAAMuD,cAAc,EAC9B/F,EAAOC,KAAKgC,QACZiO,EAAgBjQ,KAAKmK,aAAaJ,EAAO,UAAU,EACnDkG,EAAc3F,OAEZqC,CADY5C,EAAMtH,QAAQ,YAAY,EAAEuG,SAAS,EACvCrG,KAAK,UAAU,EAAED,SAC3B3C,EAAKkB,oBACHiN,EAAWnE,EAAMtH,QAAQ,YAAY,EAAE0L,KAAK,EAC5CC,EAAWrE,EAAMtH,QAAQ,YAAY,EAAE4L,KAAK,EAC5C2B,EAAOjH,GAAG,WAAW,EACnBmF,EAASnF,GAAG,SAAS,GACvB/I,KAAKmN,aAAapD,EAAO,MAAM,EAC/B/J,KAAK+E,iBAAiBgF,EAAM,UAAU,IAEtC/J,KAAK+K,aAAahB,EAAO,MAAM,EAC/B/J,KAAKkF,iBAAiB6E,EAAO,UAAU,GAGrCqE,EAASrF,GAAG,SAAS,GACvB/I,KAAKmN,aAAapD,EAAO,OAAO,EAChC/J,KAAK+E,iBAAiBgF,EAAM,UAAU,IAEtC/J,KAAK+K,aAAahB,EAAO,OAAO,EAChC/J,KAAKkF,iBAAiB6E,EAAO,UAAU,IAIvCkG,EAAc1F,SAChBvK,KAAK+K,aAAahB,CAAK,EACvB/J,KAAKkF,iBAAiB6E,EAAO,UAAU,IAEvC/J,KAAKmN,aAAapD,CAAK,EACvB/J,KAAK+E,iBAAiBgF,EAAO,UAAU,GAI/C,EAEAmG,qBAAsB,SAAU3N,GAC9B5C,EAAE4C,EAAMuD,cAAc,EAAElD,YAAY,WAAW,EAC5CD,KAAK,YAAY,EAAEC,YAAY,WAAW,EAC1CO,SAAS,sBAAsB,EAAEU,SAAS,QAAQ,EAAEiJ,IAAI,EACxD3J,SAAS,oBAAoB,EAAEP,YAAY,QAAQ,EACtDjD,EAAE4C,EAAMuD,cAAc,EAAE3C,SAAS,sBAAsB,EAAEU,SAAS,QAAQ,EAAEiJ,IAAI,EAC7E3J,SAAS,oBAAoB,EAAEP,YAAY,QAAQ,CACxD,EAEAuN,mBAAoB,SAAU5N,GAC5B5C,EAAE4C,EAAMuD,cAAc,EACnBjC,SAAS,WAAW,EACpBV,SAAS,oBAAoB,EAAEU,SAAS,QAAQ,EAAEiJ,IAAI,EACtD3J,SAAS,sBAAsB,EAAEP,YAAY,QAAQ,CAC1D,EAEAwN,gBAAiB,SAAU7N,GACzBA,EAAML,KAAKmO,OAAOzN,YAAY,SAAS,CACzC,EAEA0N,kBAAmB,SAAU/N,GAC3BA,EAAML,KAAKmO,OAAOzN,YAAY,SAAS,EAAEH,QAAQ,IAAI,EAAEoB,SAAS,QAAQ,CAC1E,EAEA0M,aAAc,SAAUhO,GACtB,IAAIuM,EAAanP,EAAE4C,EAAMC,MAAM,EAC3BgO,EAAe1B,EAAWhG,OAAO,EAAEuF,KAAK,EACxCkB,EAAeiB,EAAa7N,KAAK,OAAO,EACxCmN,EAAYU,EAAarN,SAAS,EAAEA,SAAS,OAAO,EACpD2M,EAAU/G,GAAG,UAAU,IAC3B+F,EAAWf,YAAe/N,KAAKgC,QAAQ7B,MAAMS,UAAtB,IAAmCZ,KAAKgC,QAAQ7B,MAAMU,QAAU,EACnF0O,EAAa3G,GAAG,CAAC,EAAEG,GAAG,WAAW,GACnCyH,EAAa5N,YAAY,QAAQ,EACjC5C,KAAKqL,QAAQyE,EAAU5D,IAAI,CAAC,CAAC,EAC7B4D,EAAUjM,SAAS,SAAS,EAAEjB,YAAY,UAAU,EAAEgG,GAAG,CAAC,EAAEoC,IAAI,gBAAiB,CAAEqF,OAAUP,CAAU,EAAG9P,KAAKoQ,eAAe,IAE9Hb,EAAa1L,SAAS,kBAAkB,EAAE+E,GAAG,CAAC,EAAEoC,IAAI,gBAAiB,CAAEqF,OAAUd,CAAa,EAAGvP,KAAKsQ,iBAAiB,EACvHf,EAAa5M,KAAK,YAAY,EAAEC,YAAe5C,KAAKgC,QAAQ7B,MAAMS,UAAtB,IAAmCZ,KAAKgC,QAAQ7B,MAAMU,QAAU,GAEhH,EAEA4P,gBAAiB,SAAUlO,GACzB,IAIImO,EAAWC,EAJXC,EAAWjR,EAAE4C,EAAMC,MAAM,EACzBzC,EAAOC,KAAKgC,QACZ6O,EAAYtO,EAAMiF,cAClBsJ,EAAY,UAAUC,KAAKvR,EAAOwR,UAAUC,UAAUC,YAAY,CAAC,EAEvE,GAAKzR,EAAS0R,cAAc,aAAa,EAQvCT,EAAYE,EAASnO,QAAQ,WAAW,EAAEU,SAAS,aAAa,EAAE+I,IAAI,CAAC,EACvEyE,EAAYhR,EAAE+Q,CAAS,EAAEvN,SAAS,EAAE+I,IAAI,CAAC,MATC,CAE1C,GAAI,EADJwE,EAAYjR,EAAS2R,gBAAgB,6BAA8B,KAAK,GACzD7M,UAAW,OAC1BmM,EAAUnM,UAAU8M,IAAI,YAAY,EACpCV,EAAYlR,EAAS2R,gBAAgB,6BAA6B,MAAM,EACxEV,EAAUY,YAAYX,CAAS,EAC/BC,EAASnO,QAAQ,WAAW,EAAEO,OAAO0N,CAAS,CAChD,CAIA,IAAIa,EAAcX,EAASnO,QAAQ,WAAW,EAAEuD,IAAI,WAAW,EAAEM,MAAM,GAAG,EACtEkL,EAAkC,QAAnBzR,EAAK0B,WAA0C,QAAnB1B,EAAK0B,UAChDgQ,EAAQxJ,KAAKK,IAAI9I,EAAO+I,WAAWiJ,EAAeD,EAAY,GAAGpC,MAAMoC,EAAY,GAAGhL,QAAQ,GAAG,EAAI,CAAC,EAAIgL,EAAY,EAAE,CAAC,EAUzHG,GATJhB,EAAUiB,aAAa,QAASH,EAAeZ,EAASgB,WAAW,CAAA,CAAK,EAAIhB,EAASiB,YAAY,CAAA,CAAK,CAAC,EACvGnB,EAAUiB,aAAa,SAAUH,EAAeZ,EAASiB,YAAY,CAAA,CAAK,EAAIjB,EAASgB,WAAW,CAAA,CAAK,CAAC,EACxGjB,EAAUgB,aAAa,IAAI,EAAIF,CAAK,EACpCd,EAAUgB,aAAa,IAAI,EAAIF,CAAK,EACpCd,EAAUgB,aAAa,QAAS,IAAMF,CAAK,EAC3Cd,EAAUgB,aAAa,SAAU,GAAKF,CAAK,EAC3Cd,EAAUgB,aAAa,KAAM,EAAIF,CAAK,EACtCd,EAAUgB,aAAa,KAAM,EAAIF,CAAK,EACtCd,EAAUgB,aAAa,eAAgB,CAAIF,CAAK,EAClCZ,EAAUiB,QAAUL,GAC9BM,EAAUlB,EAAUmB,QAAUP,EACX,QAAnB1R,EAAK0B,WACPiQ,EAAUb,EAAUmB,QAAUP,EAC9BM,EAAUlB,EAAUiB,QAAUL,GACF,QAAnB1R,EAAK0B,WACdiQ,EAAUd,EAASgB,WAAW,CAAA,CAAK,EAAIf,EAAUmB,QAAUP,EAC3DM,EAAUlB,EAAUiB,QAAUL,GACF,QAAnB1R,EAAK0B,YACdiQ,EAAUd,EAASgB,WAAW,CAAA,CAAK,EAAIf,EAAUiB,QAAUL,EAC3DM,EAAUnB,EAASiB,YAAY,CAAA,CAAK,EAAIhB,EAAUmB,QAAUP,GAE1DX,GACFH,EAAUgB,aAAa,OAAQ,oBAAoB,EACnDhB,EAAUgB,aAAa,SAAU,gBAAgB,GAC7CM,EAAmBxS,EAASyS,cAAc,KAAK,GAClCC,IAAM,4BAA6B,IAAKC,eAAiBC,kBAAkB3B,CAAS,EACrGG,EAAUyB,aAAaC,aAAaN,EAAkBP,EAASK,CAAO,GAGlElB,EAAUyB,aAAaC,cACzB1B,EAAUyB,aAAaC,aAAa7B,EAAWgB,EAASK,CAAO,CAErE,EAEAS,cAAe,SAAUzI,GACvB,OAAKA,EAAMhB,GAAG,OAAO,EAGdgB,EAAMjG,QAAQ,YAAY,EAAEpB,OAF1B,CAGX,EAEA+P,cAAe,SAAU1I,GACvB,OAAKA,EAAMhB,GAAG,OAAO,EAGdgB,EAAMtH,QAAQ,YAAY,EAAEE,KAAK,QAAQ,EAAED,OAAS,EAFlD,CAGX,EAEAgQ,mBAAoB,SAAU7P,GAC5B,GAAG,CAACA,EAAO,MAAO,GAClB,IAAI8P,EAAQ,GACRC,EAAS,GAEb,IADAD,EAAMxJ,KAAKtG,CAAK,EACV8P,EAAMjQ,QAAQ,CAElB,IADA,IAAImQ,EAAM,GACFzO,EAAI,EAAGA,EAAIuO,EAAMjQ,OAAQ0B,CAAC,GAAI,CAClC,IAAI0O,EAAMH,EAAMI,MAAM,EAClB5P,EAAWnD,KAAK0K,YAAYoI,CAAG,EAChC3P,EAAST,QACViQ,EAAMxJ,KAAKhG,EAAS6P,QAAQ,EAAEC,KAAK,CAAC,EAEtCJ,EAAI1J,KAAKxJ,EAAEmT,CAAG,CAAC,CACnB,CACAF,EAAOzJ,KAAK0J,CAAG,CACjB,CACA,OAAOD,CACT,EAEAM,uBAAwB,SAAUC,GAChC,IAAIpT,EAAOC,KAAKgC,QAEZoR,EAAeD,EAAS1Q,QAAQ,aAAa,EAAE4Q,SAAS,MAAM,EAC9DC,EAAYH,EAAS1Q,QAAQ,QAAQ,EAAEuG,SAAS,OAAO,EACvDuK,EAAYJ,EAAS1Q,QAAQ,YAAY,EAAEE,KAAK,OAAO,EAC3D3C,KAAKmC,OAAOD,KAAK,UAAWiR,CAAQ,EACjCxQ,KAAK,OAAO,EAAEe,KAAK,SAAUC,EAAOC,GAC9BwP,GAA0C,CAAC,IAA3BG,EAAU5P,MAAMC,CAAI,GACnC7D,EAAKyT,cACHzT,CAAAA,EAAKyT,aAAaL,EAAUG,EAAW3T,EAAEiE,CAAI,CAAC,GAIlDjE,EAAEiE,CAAI,EAAEC,SAAS,aAAa,CAGpC,CAAC,CACL,EAEA4P,iBAAkB,SAAUlR,GAC1BA,EAAMiF,cAAc8K,aAAaoB,QAAQ,YAAa,kBAAkB,EAEnC,SAAjC1T,KAAKmC,OAAO6D,IAAI,WAAW,GAC7BhG,KAAKyQ,gBAAgBlO,CAAK,EAE5BvC,KAAKkT,uBAAuBvT,EAAE4C,EAAMC,MAAM,CAAC,CAC7C,EAEAmR,gBAAiB,SAAUpR,GACpB5C,EAAE4C,EAAMuD,cAAc,EAAEiD,GAAG,cAAc,EAK5CxG,EAAM+C,eAAe,EAJrB/C,EAAMiF,cAAc8K,aAAasB,WAAa,MAMlD,EAEAC,eAAgB,SAAUtR,GACxBvC,KAAKmC,OAAOQ,KAAK,cAAc,EAAEC,YAAY,aAAa,CAC5D,EAEAkR,YAAaC,eAAgBxR,GAC3B,IAgBI+Q,EAOAU,EAKEC,EAoBEC,EAKAC,EApDJC,EAAYzU,EAAE4C,EAAMuD,cAAc,EAClCqN,EAAWnT,KAAKmC,OAAOD,KAAK,SAAS,EAGpCiR,EAASE,SAAS,MAAM,EAKxBe,EAAUf,SAAS,aAAa,IAMjCC,EAAYH,EAAS1Q,QAAQ,QAAQ,EAAEuG,SAAS,OAAO,EACvDqL,EAAY1U,EAAEgF,MAAM,mBAAmB,EAC3C3E,KAAKmC,OAAOyC,QAAQyP,EAAW,CAAEC,YAAenB,EAAUoB,SAAYjB,EAAWkB,SAAYJ,CAAU,CAAC,EACpGC,EAAUI,mBAAmB,IAI7BT,EAAahU,KAAKmC,OAAOD,KAAK,SAAS,EAAEA,KAEvCwS,GADFC,EAAS,IAAIC,WAAWZ,EAAYhU,KAAKmC,OAAOD,KAAK,SAAS,EAAElB,OAAQ,UAAU,GAC5D6T,YAAY,CAAEnL,OAAU,CAAA,CAAK,CAAC,EACR,EAA5C1J,KAAKmC,OAAOD,KAAK,SAAS,EAAE4S,eAAqBJ,GAC/CJ,EAAcK,EAAOI,aAAa5B,EAASjR,KAAK,UAAU,EAAE8H,EAAE,EAC9DiK,EAAOe,OAAOC,OAAO,GAAIX,CAAW,EACxCK,EAAOO,WAAWZ,EAAYtK,EAAE,GAC5BmL,EAAWR,EAAOI,aAAaX,EAAUlS,KAAK,UAAU,EAAE8H,EAAE,GACnD7G,SACXgS,EAAShS,SAASgG,KAAK8K,CAAI,EAE3BkB,EAAShS,SAAW,CAAC8Q,GAlCdjU,KAoCJ+B,KAAK,CAAEG,KAAQ8R,CAAW,CAAC,IAI3BI,EAAUpL,SAAS,QAAQ,EAAEtG,QAQ5BwR,6CAA6DlU,KAAKgC,QAAQ7B,MAAMC,qDAAqDJ,KAAKgC,QAAQ7B,MAAMC,cACvJ+S,EAASxQ,KAAK,iBAAiB,EAAED,QACpCyQ,EAASnQ,OAAOkR,CAAe,EAEjCE,EAAUpL,SAAS,QAAQ,EAAEhG,OAAOmQ,EAAS1Q,QAAQ,YAAY,CAAC,EAEzC,KADrB0R,EAAYhB,EAAS1Q,QAAQ,YAAY,EAAEuG,SAAS,EAAErG,KAAK,aAAa,GAC9DD,QACZyR,EAAUnR,OAAOkR,CAAe,IAdlCE,EAAUpR,iDAAiDhD,KAAKgC,QAAQ7B,MAAMC,aAAa,EACxFoF,MAAM,yBAAyB,EAC/BwD,SAAS,QAAQ,EAAEhG,OAAOmQ,EAASxQ,KAAK,iBAAiB,EAAEP,OAAO,EAAE0K,IAAI,EAAErK,QAAQ,YAAY,CAAC,EAC9F2R,EAAUjR,SAAS,QAAQ,EAAET,QAC/B0R,EAAUjR,SAAS,QAAQ,EAAEiS,qBAAqBpV,KAAKgC,QAAQ7B,MAAMC,SAASJ,KAAKmC,OAAOD,KAAK,SAAS,EAAE/B,MAAME,mCAAmC,GAcpF,IAA/DiT,EAAUtK,SAAS,QAAQ,EAAE7F,SAAS,YAAY,EAAET,OACtD4Q,EAAUtK,SAAS,QAAQ,EAAE7F,SAAS,YAAY,EAAER,KAAK,aAAa,EACnEA,KAAK,iBAAiB,EAAEP,OAAO,EACsC,IAA/DkR,EAAUtK,SAAS,QAAQ,EAAE7F,SAAS,YAAY,EAAET,QAC7D4Q,EAAU3Q,KAAK,gCAAgC,EAAEP,OAAO,EACrD0K,IAAI,EAAE9D,SAAS,QAAQ,EAAE5G,OAAO,KA1DrCpC,KAAKmC,OAAOkT,eAAe,CAAEtG,KAAQ,wBAAyBuG,YAAenC,EAAUqB,SAAYJ,CAAU,CAAC,CA6DlH,EAEAmB,kBAAmB,SAAUhT,GACvBvC,KAAKwV,cAGLjT,EAAMwD,SAAkC,EAAvBxD,EAAMwD,QAAQrD,SAGnC1C,KAAKwV,aAAe,CAAA,EACpBxV,KAAKyV,WAAa,CAAA,EAClBlT,EAAM+C,eAAe,EACvB,EAEAoQ,iBAAkB,SAAUnT,GAC1B,IAsBMoT,EAtBD3V,CAAAA,KAAKwV,cAGNjT,EAAMwD,SAAkC,EAAvBxD,EAAMwD,QAAQrD,SAGnCH,EAAM+C,eAAe,EAEhBtF,KAAKyV,aAERzV,KAAKkT,uBAAuBvT,EAAE4C,EAAMqT,aAAa,CAAC,EAElD5V,KAAK6V,eAAiB7V,KAAK8V,gBAAgBvT,EAAOvC,KAAKmC,OAAOD,KAAK,SAAS,EAAE,EAAE,GAElFlC,KAAKyV,WAAa,CAAA,EAGlBzV,KAAK+V,cAAcxT,EAAOvC,KAAK6V,cAAc,EAIjB,GADxBG,EADYrW,EAAEF,EAASwW,iBAAiB1T,EAAMwD,QAAQ,GAAGoC,QAAS5F,EAAMwD,QAAQ,GAAGqC,OAAO,CAAC,EAChE3F,QAAQ,UAAU,GAC9BC,SACbiT,EAAsBK,EAAe,GACrCA,EAAejN,GAAG,cAAc,GAClC/I,KAAKkW,gBAAkBP,EAOzB3V,KAAKkW,gBAAkB,KAE3B,EAEAC,gBAAiB,SAAU5T,GACzB,IAeQ6T,EACAC,EAhBHrW,KAAKwV,eAGVxV,KAAKsW,iBAAiB,EAClBtW,KAAKyV,YAEDzV,KAAKkW,kBACDK,EAA0B,CAAEzQ,eAAgB9F,KAAKkW,eAAgB,EACrElW,KAAK8T,YAAYyC,CAAuB,EACxCvW,KAAKkW,gBAAkB,MAE3BlW,KAAK6T,eAAetR,CAAK,IAIrB6T,EAAa7T,EAAMiU,eAAe,IAClCH,EAAsB5W,EAASgX,YAAY,aAAa,GACxCC,eAAe,QAAS,CAAA,EAAM,CAAA,EAAMlX,EAAQ,EAAG4W,EAAWO,QAASP,EAAWQ,QAASR,EAAWjO,QAASiO,EAAWhO,QAAS7F,EAAMsU,QAAStU,EAAMuU,OAAQvU,EAAMwU,SAAUxU,EAAMyU,QAAS,EAAG,IAAI,EACtNzU,EAAMC,OAAOyU,cAAcZ,CAAmB,GAElDrW,KAAKwV,aAAe,CAAA,EACtB,EAEAM,gBAAiB,SAAUvT,EAAO2U,GAChC,IAAIC,EAAYD,EAAOE,UAAU,CAAA,CAAI,EAGjCC,GAFJrX,KAAKsX,UAAUJ,EAAQC,CAAS,EAChCA,EAAU5I,MAAMgJ,IAAMJ,EAAU5I,MAAMiJ,KAAO,UACvBN,EAAOO,sBAAsB,GAC/CC,EAAc1X,KAAK2X,cAAcpV,CAAK,EAI1C,OAHAvC,KAAK4X,qBAAuB,CAAEC,EAAGH,EAAYG,EAAIR,EAAgBG,KAAMM,EAAGJ,EAAYI,EAAIT,EAAgBE,GAAI,EAC9GJ,EAAU5I,MAAMwJ,QAAU,MAC1BtY,EAASuY,KAAK1G,YAAY6F,CAAS,EAC5BA,CACT,EAEAb,iBAAkB,WACZtW,KAAK6V,gBAAkB7V,KAAK6V,eAAeoC,eAC7CjY,KAAK6V,eAAeoC,cAAcC,YAAYlY,KAAK6V,cAAc,EACnE7V,KAAK4X,qBAAuB,KAC5B5X,KAAK6V,eAAiB,IACxB,EAEAyB,UAAW,SAAUnF,EAAKgG,GAEJ,CAAC,KAAM,QAAS,QAAS,aAC/B3O,QAAQ,SAAU4O,GAC5BD,EAAIE,gBAAgBD,CAAG,CAC3B,CAAC,EAEGjG,aAAemG,qBACDC,EAAOJ,GAClBK,OADDC,EAAOtG,GACOqG,MAClBD,EAAKG,OAASD,EAAKC,OACnBH,EAAKI,WAAW,IAAI,EAAEC,UAAUH,EAAM,EAAG,CAAC,GAI5C,IAbA,IAMMA,EAAYF,EAMdM,EAAKC,iBAAiB3G,CAAG,EACpB/N,EAAI,EAAGA,EAAIyU,EAAGnW,OAAQ0B,CAAC,GAAI,CAClC,IAAI6E,EAAM4P,EAAGzU,GACT6E,EAAI1C,QAAQ,YAAY,EAAI,IAC9B4R,EAAI5J,MAAMtF,GAAO4P,EAAG5P,GAExB,CACAkP,EAAI5J,MAAMwK,cAAgB,OAE1B,IAAS3U,EAAI,EAAGA,EAAI+N,EAAIhP,SAAST,OAAQ0B,CAAC,GACxCpE,KAAKsX,UAAUnF,EAAIhP,SAASiB,GAAI+T,EAAIhV,SAASiB,EAAE,CAEnD,EAEAuT,cAAe,SAAUpV,GAIvB,MAAO,CACLsV,GAHAtV,EADEA,GAASA,EAAMwD,QACTxD,EAAMwD,QAAQ,GAGnBxD,GAAM4F,QACT2P,EAAGvV,EAAM6F,OACX,CACF,EAEA2N,cAAe,SAAUxT,EAAOyW,GAC9B,IAEIC,EAFC1W,GAAUyW,IAEXC,EAAiBjZ,KACrBkZ,sBAAsB,WACpB,IAAIC,EAAKF,EAAetB,cAAcpV,CAAK,EACvC6W,EAAIJ,EAAMzK,MACd6K,EAAEC,SAAW,WACbD,EAAEL,cAAgB,OAClBK,EAAEE,OAAS,SACPL,EAAerB,uBACfwB,EAAE5B,KAAOvP,KAAKsR,MAAMJ,EAAGtB,EAAIoB,EAAerB,qBAAqBC,CAAC,EAAI,KACpEuB,EAAE7B,IAAMtP,KAAKsR,MAAMJ,EAAGrB,EAAImB,EAAerB,qBAAqBE,CAAC,EAAI,KAEzE,CAAC,EACH,EAEA0B,aAAc,SAAUzP,GACtBA,EAAMlD,GAAG,YAAa7G,KAAKyT,iBAAiBnI,KAAKtL,IAAI,CAAC,EACnD6G,GAAG,WAAY7G,KAAK2T,gBAAgBrI,KAAKtL,IAAI,CAAC,EAC9C6G,GAAG,UAAW7G,KAAK6T,eAAevI,KAAKtL,IAAI,CAAC,EAC5C6G,GAAG,OAAQ7G,KAAK8T,YAAYxI,KAAKtL,IAAI,CAAC,EACtC6G,GAAG,aAAc7G,KAAKuV,kBAAkBjK,KAAKtL,IAAI,CAAC,EAClD6G,GAAG,YAAa7G,KAAK0V,iBAAiBpK,KAAKtL,IAAI,CAAC,EAChD6G,GAAG,WAAY7G,KAAKmW,gBAAgB7K,KAAKtL,IAAI,CAAC,CACnD,EAEAyZ,WAAY,SAAUvX,GACpB,IACInC,EAAOC,KAAKgC,QACZ0X,EAAQxX,EAAKwX,MAOb9I,GANA1O,EAAKiB,UAAYjB,EAAKnC,EAAKiB,SAC7BrB,EAAE+D,KAAKxB,EAAKiB,SAAU,SAAUQ,EAAOgW,GACrCA,EAAMzK,SAAWhN,EAAKnC,EAAKiB,OAC7B,CAAC,EAGYrB,EAAE,QAAUI,EAAKyB,UAAY,oBAAsB,KAAOU,EAAKnC,EAAKiB,QAAU,QAAUkB,EAAKnC,EAAKiB,QAAU,IAAM,KAAOkB,EAAKgN,SAAW,iBAAmBhN,EAAKgN,SAAW,IAAM,IAAM,GAAG,EACvMrL,SAAS,SAAW3B,EAAK0X,WAAa,KAAQF,EAAQ3Z,EAAKmB,aAAe,YAAc,GAAG,GAQ1F2Y,GAPA9Z,EAAK+Z,aACPlJ,EAAS5N,OAAOjD,EAAK+Z,aAAa5X,CAAI,CAAC,EAEvC0O,EAAS5N,OAAO,sBAAwBd,EAAKnC,EAAKgB,WAAa,QAAQ,EACpEiC,OAAmC,KAAA,IAArBjD,EAAKga,YAA8B,yBAA2B7X,EAAKnC,EAAKga,cAAgB,IAAM,SAAW,EAAE,EAG/Gpa,EAAEsC,OAAO,GAAIC,CAAI,GAI5BkH,GAHJ,OAAOyQ,EAAS1W,SAChByN,EAAS1O,KAAK,WAAY2X,CAAQ,EAEtB3X,EAAKkB,cAAgB,IAuDjC,OAtDKrD,EAAK+U,eAAiB4E,GAAS3Z,EAAK+U,eAAkB5S,EAAKyH,SAC1DqQ,OAAO5Q,EAAM6Q,OAAO,EAAE,CAAC,CAAC,GAC1BrJ,EAAS5N,8BAA8BjD,EAAKI,MAAMC,aAAa,EAC5D+C,SAAS,QAAQ,EAAEiS,qBAAqBrV,EAAKI,MAAMC,SAASL,EAAKI,MAAME,mCAAmC,EAEtG6B,EAAKwH,OACVsQ,OAAO5Q,EAAM6Q,OAAO,EAAE,CAAC,CAAC,GAC1BrJ,EAAS5N,iDAAiDjD,EAAKI,MAAMC,aAAa,EAC/E+C,SAAS,QAAQ,EAAEiS,qBAAqBrV,EAAKI,MAAMC,SAASL,EAAKI,MAAME,mCAAmC,EAEtG6B,EAAKmH,SACduH,EAAS5K,IAAI,kCAAmCiC,KAAKiS,MAAMjS,KAAKC,KAAKhG,EAAKiB,SAAST,OAAS,CAAC,CAAC,UAAU,EACpGsX,OAAO5Q,EAAM6Q,OAAO,EAAE,CAAC,CAAC,GAC1BrJ,EAAS5N;wBACKjD,EAAKI,MAAMC,SAASL,EAAKI,MAAMO;wBAC/BX,EAAKI,MAAMC,SAASL,EAAKI,MAAMQ;aAC1C,EACAwC,SAAS,QAAQ,EAAEiS,qBAAqBrV,EAAKI,MAAMC,SAASL,EAAKI,MAAME,mCAAmC,GAEtG6B,EAAK0H,oBAGVoQ,OAAO5Q,EAAM6Q,OAAO,EAAE,CAAC,CAAC,GAC1BrJ,EAAS5N,8CAA8CjD,EAAKI,MAAMC,aAAa,EAE9E4Z,OAAO5Q,EAAM6Q,OAAO,EAAE,CAAC,CAAC,GACzBrJ,EAAS5N,kDAAkDjD,EAAKI,MAAMC,qDAAqDL,EAAKI,MAAMC,aAAa,EAElJ4Z,OAAO5Q,EAAM6Q,OAAO,EAAE,CAAC,CAAC,GACzBrJ,EAAS5N,iDAAiDjD,EAAKI,MAAMC,aAAa,EAC/E+C,SAAS,QAAQ,EAAEiS,qBAAqBrV,EAAKI,MAAMC,SAASL,EAAKI,MAAME,mCAAmC,GAIjHuQ,EAAS/J,GAAG,wBAAyB7G,KAAKyO,sBAAsBnD,KAAKtL,IAAI,CAAC,EAC1E4Q,EAAS/J,GAAG,QAAS7G,KAAKgP,iBAAiB1D,KAAKtL,IAAI,CAAC,EACrD4Q,EAAS/J,GAAG,QAAS,WAAY7G,KAAK0P,oBAAoBpE,KAAKtL,IAAI,CAAC,EACpE4Q,EAAS/J,GAAG,QAAS,cAAe7G,KAAK4P,uBAAuBtE,KAAKtL,IAAI,CAAC,EAC1E4Q,EAAS/J,GAAG,QAAS,wBAAyB7G,KAAK+P,kBAAkBzE,KAAKtL,IAAI,CAAC,EAC/E4Q,EAAS/J,GAAG,QAAS,aAAc7G,KAAKuQ,aAAajF,KAAKtL,IAAI,CAAC,EAC/D4Q,EAAS/J,GAAG,QAAS,yBAAyB7G,KAAKkQ,qBAAqB5E,KAAKtL,IAAI,CAAC,EAClF4Q,EAAS/J,GAAG,QAAS,uBAAuB7G,KAAKmQ,mBAAmB7E,KAAKtL,IAAI,CAAC,EAE1ED,EAAKyB,YACPxB,KAAKwZ,aAAa5I,CAAQ,EAC1B5Q,KAAKwV,aAAe,CAAA,EACpBxV,KAAKyV,WAAa,CAAA,EAClBzV,KAAKkW,gBAAkB,MAGrBnW,EAAK0Z,YACP1Z,EAAK0Z,WAAW7I,EAAU1O,CAAI,EAGzB0O,CACT,EAEA3N,eAAgB,SAAUkX,EAAWjY,GACnC,IAGI0O,EAaEwJ,EACAC,EAjBFtW,EAAO/D,KACPD,EAAOC,KAAKgC,QACZ0X,EAAQ,EAGVA,EADExX,EAAKwX,QAGCxX,EAAKwX,MAAQS,EAAUG,aAAa,YAAa,QAAQ,EAAE5X,QAGtC,EAA3BsS,OAAOuF,KAAKrY,CAAI,EAAEQ,SACpBkO,EAAW5Q,KAAKyZ,WAAWvX,CAAI,EAC/BiY,EAAUnX,OAAO4N,CAAQ,GAGvB1O,EAAKiB,UAAYjB,EAAKiB,SAAST,SAC7B0X,EAAWV,EAAQ,EAAI3Z,EAAKmB,cAAiBgB,EAAKtB,YAAchB,GAAasC,EAAKtB,UAEjFb,EAAK+U,eAAkB4E,EAAQ,GAAM3Z,EAAK+U,eAAkB5S,EAAKwH,QACpE2Q,EAAc1a,EAAE,oBAAoB,EAChCya,GAAara,EAAK+U,eAAkB4E,EAAQ,GAAM3Z,EAAK+U,eACzDuF,EAAYxW,SAAS,QAAQ,GAEzB9D,EAAK+U,eAAiB4E,EAAQ,IAAM3Z,EAAK+U,eAAkB5S,EAAKwH,SACjE,CAACyQ,EAAU1X,QAAQ,WAAW,EAAEC,OACjCyX,EAAUnX,OAAOqX,EAAYxW,SAAS,UAAU,CAAC,EAEnDsW,EAAUnX,OAAOqX,CAAW,GAErBnY,EAAKmH,QACduH,EAAS/M,SAAS,SAAS,GAE3BwW,EAAc1a,EAAE,oBAAsBya,EAAW,UAAY,IAAM,IAAI,EACtC,IAA7BpF,OAAOuF,KAAKrY,CAAI,EAAEQ,QAGhB0X,GACFD,EAAUtW,SAAS,qBAAqB,EAE1CsW,EAAUnX,OAAOqX,CAAW,GAIhC1a,EAAE+D,KAAKxB,EAAKiB,SAAU,WAEpB,IAGMqX,EAJNxa,KAAK0Z,MAAQA,EAAQ,EACjBxX,EAAKmH,QACPtF,EAAKd,eAAe2N,EAAU5Q,IAAI,GAE9Bwa,EAAY7a,EAAE,wBAAwB,EAC1C0a,EAAYrX,OAAOwX,CAAS,EAC5BzW,EAAKd,eAAeuX,EAAWxa,IAAI,EAEvC,CAAC,EAEL,EAEAya,eAAgB,SAAUN,EAAWjY,GACnClC,KAAKiD,eAAekX,EAAW,CAAEhX,SAAYjB,CAAK,CAAC,CACrD,EAEAwY,YAAa,SAAU3Q,EAAO7H,GAC5BlC,KAAKya,eAAe1Q,EAAMtH,QAAQ,YAAY,EAAGP,CAAI,EAChD6H,EAAMpH,KAAK,mBAAmB,EAAED,QACnCqH,EAAM5G,SAAS,QAAQ,EAAEiS,qBAAqBpV,KAAKgC,QAAQ7B,MAAMC,SAASJ,KAAKgC,QAAQ7B,MAAME,mCAAmC,EAE9H0J,EAAMtH,QAAQ,iBAAiB,EAAEC,OAC9BqH,EAAM5G,SAAS,YAAY,EAAET,QAChCqH,EAAM/G,8BAA8BhD,KAAKgC,QAAQ7B,MAAMC,aAAa,EAGjE2J,EAAM5G,SAAS,aAAa,EAAET,QACjCqH,EAAM/G,iDAAiDhD,KAAKgC,QAAQ7B,MAAMC,aAAa,EAGvFJ,KAAKkL,WAAWnB,CAAK,GACvB/J,KAAKmL,oBAAoBpB,EAAM5G,SAAS,aAAa,CAAC,CAE1D,EAEAwX,gBAAiB,SAAUC,EAAc1Y,GACvCA,EAAKkB,aAAelB,EAAKkB,cAAgB,MACrCyX,EAAkBlb,EAAE,oDAAoD,EACzEgD,KAAK,YAAY,EAAEK,OAAOhD,KAAKyZ,WAAWvX,CAAI,CAAC,EAAE4K,IAAI,EACxD9M,KAAKmC,OAAOiT,QAAQyF,CAAe,EAChClY,KAAK,kBAAkB,EAAEK,OAAO4X,EAAanY,QAAQ,IAAI,EAAEoB,SAAS,OAAO,CAAC,CACjF,EAEAiX,UAAW,SAAUF,EAAc1Y,GACjClC,KAAK2a,gBAAgBC,EAAc1Y,CAAI,EAClC0Y,EAAazX,SAAS,UAAU,EAAET,QACrCkY,EAAazX,SAAS,QAAQ,EAAEqC,6CAA6CxF,KAAKgC,QAAQ7B,MAAMC,aAAa,EAE3GJ,KAAKkL,WAAW0P,CAAY,GAC9B5a,KAAKmL,oBAAoByP,EAAazX,SAAS,UAAU,CAAC,CAE9D,EAEA4X,iBAAkB,SAAUC,EAAY9Y,GACtC,IAOMyK,EAPFsO,GAAkBtb,EAAEub,QAAQhZ,CAAI,EAAIA,EAAcA,EAAKiB,UAAdT,OACzCyY,EAAsBH,EAAWlS,OAAO,EAAEC,GAAG,QAAQ,EAAIiS,EAAWhS,SAAS,EAAEtG,OAAS,EAAI,EAC5F0Y,EAAeD,EAAsBF,EACrCI,EAAgC,EAAfD,EAAoBnT,KAAKiS,MAAMkB,EAAa,EAAI,CAAC,EAAI,EAEtEJ,EAAWvY,QAAQ,QAAQ,EAAEqG,OAAO,EAAEC,GAAG,YAAY,GACvD/I,KAAKya,eAAeO,EAAWlS,OAAO,EAAErG,QAAQ,YAAY,EAAGP,CAAI,EAC/DyK,EAAYqO,EAAWlS,OAAO,EAAErG,QAAQ,YAAY,EAAEU,SAAS,aAAa,EAAEA,SAAS,YAAY,EAC7E,EAAtBgY,EACFxO,EAAU/D,GAAG,CAAC,EAAE0S,OAAON,EAAWhS,SAAS,EAAEuS,QAAQ,EAAEC,OAAO,CAAC,EAE/D7O,EAAU/D,GAAGyS,CAAa,EAAE7V,MAAMwV,EAAWQ,OAAO,CAAC,IAGvDxb,KAAKiD,eAAe+X,EAAWlS,OAAO,EAAEsM,QAAQzV,EAAE,wBAAwB,CAAC,EAAEwD,SAAS,kBAAkB,EAAGjB,CAAI,EAC/G8Y,EAAWpO,QAAQ,YAAY,EAAEzJ,SAAS,QAAQ,EAAEA,SAAS,EAAEyF,GAAGyS,CAAa,EAAE7V,MAAMwV,CAAU,EAErG,EAEAS,YAAa,SAAU1R,EAAO7H,GAC5BlC,KAAK+a,iBAAiBhR,EAAMtH,QAAQ,YAAY,EAAGP,CAAI,EACvD6H,EAAMtH,QAAQ,QAAQ,EAAEP,KAAK,iBAAkB,CAAA,CAAI,EAC9C6H,EAAM5G,SAAS,WAAW,EAAET,QAC/BqH,EAAM5G,SAAS,UAAU,EAAEqC,iDAAiDxF,KAAKgC,QAAQ7B,MAAMC,qDAAqDJ,KAAKgC,QAAQ7B,MAAMC,aAAa,EAElLJ,KAAKkL,WAAWnB,CAAK,IACvB/J,KAAK+M,sBAAsBhD,CAAK,EAChCA,EAAM5G,SAAS,UAAU,EAAEP,YAAY5C,KAAKgC,QAAQ7B,MAAMG,UAAU,EAAEuD,SAAS7D,KAAKgC,QAAQ7B,MAAMI,cAAc,EAEpH,EAEAmb,YAAa,SAAU3R,GACrB,IAAI4R,EAAW5R,EAAMtH,QAAQ,YAAY,EAAEqG,OAAO,EAC9C6S,EAAS7S,OAAO,EAAEC,GAAG,YAAY,EAC/B/I,KAAKmK,aAAaJ,EAAO,UAAU,EAAEO,OACvCP,EAAMtH,QAAQ,YAAY,EAAEL,OAAO,EACA,IAA/BuZ,EAASxY,SAAS,EAAET,QACtBiZ,EAAShZ,KAAK,6BAA6B,EAAEP,OAAO,GAGtDuZ,EAAS3S,SAAS,OAAO,EAAErG,KAAK,aAAa,EAAEP,OAAO,EACnD0K,IAAI,EAAEA,IAAI,EAAE1K,OAAO,EAGxBuZ,EAASlZ,QAAQ,WAAW,EAAEL,OAAO,CAEzC,EAEAwZ,cAAe,WAEK5b,KACNmC,OAAOQ,KAAK,cAAc,EACnCC,YAAY,aAAa,CAC9B,EAEAiZ,cAAe,SAAUC,GAGL9b,KACNmC,OAAOQ,KAAK,OAAO,EAC5Be,KAAK,SAAUC,EAAOC,GACrBjE,EAAEiE,CAAI,EAAEC,SAAS,aAAa,CAChC,CAAC,EAJe7D,KAKNmC,OAAOD,KAAK,UAAWvC,EAAEmc,CAAO,CAAC,CAC/C,EAEAC,oBAAqB,SAAUvH,EAAUsH,GAEnCA,GACF9b,KAAKmC,OAAOD,KAAK,UAAWvC,EAAEmc,CAAO,CAAC,EAEpBtH,EAAS/R,QAAQ,OAAO,EAG9B4S,eAAe,CAAEtG,KAAQ,MAAO,CAAC,CACjD,EAEAiN,UAAW,SAASC,EAAQ3a,GAC1B,IAAI4a,EAAM,GACNC,EAAWlU,KAAKiS,MAAM+B,EAAOzD,KAAK,EAClC4D,EAAYnU,KAAKiS,MAAM+B,EAAOvD,MAAM,EACnClZ,EAAO6c,QACV7c,EAAO6c,MAAQ7c,EAAO8c,MAAMD,QAI5BH,EADaE,EAAXD,EACI,IAAIE,MAAM,CACdE,YAAa,YACbC,KAAM,KACNC,OAAQ,CAACN,EAAUC,EACrB,CAAC,EAEK,IAAIC,MAAM,CACdE,YAAa,WACbC,KAAM,KACNC,OAAQ,CAACL,EAAWD,EACtB,CAAC,GAECO,SAAST,EAAOU,UAAU,EAAG,MAAO,EAAG,CAAC,EAC5CT,EAAIU,KAAKtb,EAAiB,MAAM,CAClC,EAEAub,UAAW,SAASZ,EAAQ3a,GAC1B,IACIwb,EAAW,qBAAsBrd,EAASsd,gBAAgBxO,MAC1DyO,EAAO,CAAC,CAACxd,EAAOyd,QAChBC,EAA+B,gCAAtBlM,UAAUmM,SAAoE,aAAtBnM,UAAUmM,SAAiE,CAAC,EAAxCnM,UAAUoM,WAAW7W,QAAQ,MAAM,EACxItG,EAAkBD,KAAKC,gBAEtB,CAAC6c,GAAY,CAACE,GAASE,EAC1B1d,EAAOwR,UAAUqM,WAAWpB,EAAOqB,SAAS,EAAGhc,EAAiB,MAAM,GAElEic,EAAW,iBAA+C,KATrDvd,KAS8BgC,QAAQb,WAAoB,IAT1DnB,KASqEgC,QAAQb,WAAa,IAE9FlB,EAAgB0C,KAAK4a,CAAQ,EAAE7a,QAClCzC,EAAgB+C,OAAO,0BAAwD,KAZxEhD,KAYiDgC,QAAQb,WAAoB,IAZ7EnB,KAYwFgC,QAAQb,WAAa,IAC3F,eAAgBG,EAAiB,YAAY,EAGxErB,EAAgB0C,KAAK4a,CAAQ,EAAE3P,KAAK,OAAQqO,EAAOU,UAAU,CAAC,EAAE,GAAGra,MAAM,EAE7E,EAEAiD,OAAQ,SAAUjE,EAAgBC,GAChC,IAAIwC,EAAO/D,KAGX,GAFAsB,EAA4C,KAAA,IAAnBA,EAAmCA,EAAiBtB,KAAKgC,QAAQV,eAC1FC,EAAsD,KAAA,IAAxBA,EAAwCA,EAAsBvB,KAAKgC,QAAQT,oBACrG5B,EAAEK,IAAI,EAAEmD,SAAS,UAAU,EAAET,OAC/B,MAAO,CAAA,EAET,IAAIzC,EAAkBD,KAAKC,gBACvBud,EAAQvd,EAAgB0C,KAAK,OAAO,EAMpC8a,GALCD,EAAM9a,OAGT8a,EAAM5a,YAAY,QAAQ,EAF1B3C,EAAgB+C,sCAAsChD,KAAKgC,QAAQ7B,MAAMC,SAASJ,KAAKgC,QAAQ7B,MAAMW,6BAA6B,EAIlHb,EAAgB4D,SAAS,iBAAiB,EAAElB,KAAK,0BAA0B,EAAEuJ,IAAI,CAAC,GAChG2C,EAAkC,QAA3B9K,EAAK/B,QAAQP,WAAkD,QAA3BsC,EAAK/B,QAAQP,UAC5Dic,YAAYD,EAAa,CACvBjF,MAAS3J,EAAO4O,EAAYE,aAAeF,EAAYG,YACvDlF,OAAU7J,EAAO4O,EAAYG,YAAcH,EAAYE,aACvDE,QAAW,SAAUC,GACnBne,EAAEme,CAAQ,EAAEnb,KAAK,kBAAkB,EAAEqD,IAAI,WAAY,SAAS,EAC3DrD,KAAK,gCAAgC,EAAEqD,IAAI,YAAa,EAAE,CAC/D,CACF,CAAC,EACA+X,KAAK,SAAU9B,GACdhc,EAAgB0C,KAAK,OAAO,EAAEkB,SAAS,QAAQ,EAEL,QAAtCtC,EAAoB2P,YAAY,EAClCnN,EAAKiY,UAAUC,EAAQ3a,CAAc,EAErCyC,EAAK8Y,UAAUZ,EAAQ3a,CAAc,EAGvCrB,EAAgB2C,YAAY,iBAAiB,CAC/C,EAAG,WACD3C,EAAgB2C,YAAY,iBAAiB,CAC/C,CAAC,CACH,CACF,EAEAjD,EAAEqe,GAAGC,SAAW,SAAUle,GACxB,OAAO,IAAIF,EAASG,KAAMD,CAAI,EAAEgC,KAAK,CACvC,CAEF,CAAE"}