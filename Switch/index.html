<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta charset="UTF-8">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

<style>

.day{
    display:inline;
    max-width:120px;
}
.dayCtn{
    font-size:10px ;
  

    height:40px;
    padding:5px;

}    
.day .switch{
    box-shadow: none;
    font-size:10px ;
}
.week{
 
}
</style>





<div id="container-fluid">
    <div id="calendar" class="">
        <div class="d-flex  justify-content-end">
            <div class="week row w-100"></div>
        </div>
    </div>
</div>



<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
<script>


const DayPanel = (data) =>{

return    `<div class="day">
            <div class="text-center">${data.date}</div>
            <div class="dayCtn border rounded alert alert-success ">
                <dayName class="float-end p-1">${data.dayName}</dayName>
                <button class="switch btn btn-sm btn-success float-start text-center">Jövök</button>
            </div>
        </div>`
}

const dayNames = [ "H","K","Sze","Cs","P","Szo","V"];

const dateFormat = (e) =>{
    let yy = e.getFullYear()
    let mm = e.getMonth()+1
    if(mm<10){ mm = `0${mm}` }
    let dd = e.getDate()
    if(dd<10){ dd = `0${dd}` }
    return({date:`${yy}-${mm}-${dd}`,dayName:dayNames[ e.getDay() == 0 ? 6 : e.getDay()-1]})
}

const dateDiff = (date1,date2) =>{
    date1 = new Date(date1.date)
    date2 = new Date(date2.date)
    const Difference_In_Time = date2.getTime() - date1.getTime()
    const Difference_In_Days = Math.round(Difference_In_Time / (1000 * 3600 * 24));
    return Difference_In_Days
}



const firstDateOfMonth = (e) =>{
    const date = e == null ? new Date() : new Date(e)
    const month = date.getMonth(); // January
    const d = new Date(date.getFullYear(), month, 1);
    return  dateFormat(d)
}




const lastDateOfMonth = (e) =>{
    const date = e == null ? new Date() : new Date(e)
    const month = date.getMonth(); // January
    const d = new Date(date.getFullYear(), month + 1, 0);
   return  dateFormat(d)
}

const firstDay = firstDateOfMonth()
const lastDay = lastDateOfMonth()

const Calendar = []

for(day=1;day<= dateDiff(firstDay,lastDay) +1;day++){
    date = new Date(firstDay.date)
    tmp = date.setDate( new Date(firstDay.date).getDate() + (day-1) );
    Calendar.push( dateFormat(new Date(tmp)) )
}

let week = 0;
Calendar.forEach((itm,key)=>{


    if(itm.dayName == "H"){
        orientation = Calendar.length-key < 7 ?  "" : "float-end"
        console.log(orientation)
        console.log(`${key} ${Calendar.length-key}`)
        
        $("#calendar").append(`
                                <div class="d-flex justify-content-end">
                                    <div class="week row col-12 ${orientation}"></div>
                                </div>`)
        
       week++ 
    }

    let row = '<div>'
    $("#calendar .week").eq(week).append( DayPanel(itm) )
})


$(document).ready(function(){


    $("body").on("click",".day .switch",function(){
       
        $(this).toggleClass("btn-success btn-danger float-start float-end")
        $(this).text(  $(this).hasClass("float-start")  ?   "Jövök" : "Pihi")
        $(this).parent().toggleClass("alert-danger alert-success")
        $(this).parent().find("dayName").toggleClass("float-start float-end")
    })
})
</script>